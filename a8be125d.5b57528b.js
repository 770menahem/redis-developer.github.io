(window.webpackJsonp=window.webpackJsonp||[]).push([[66],{134:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return c})),a.d(t,"metadata",(function(){return s})),a.d(t,"toc",(function(){return p})),a.d(t,"default",(function(){return d}));var n=a(3),r=a(7),i=(a(0),a(162)),l=a(168),o=a(169),c=(a(163),a(164),{id:"index-ratelimiting",title:"How to build a Rate Limiter using Redis",sidebar_label:"How to build a Rate Limiter using Redis",slug:"/howtos/ratelimiting"}),s={unversionedId:"howtos/ratelimiting/index-ratelimiting",id:"howtos/ratelimiting/index-ratelimiting",isDocsHomePage:!1,title:"How to build a Rate Limiter using Redis",description:"My Image",source:"@site/docs/howtos/ratelimiting/index-ratelimiting.mdx",slug:"/howtos/ratelimiting",permalink:"/howtos/ratelimiting",editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/ratelimiting/index-ratelimiting.mdx",version:"current",sidebar_label:"How to build a Rate Limiter using Redis",sidebar:"docs",previous:{title:"How to build a Real-Time Leaderboard app Using Redis",permalink:"/howtos/leaderboard"},next:{title:"How to cache REST API responses Using Redis & NodeJS",permalink:"/howtos/caching"}},p=[{value:"Step 1. Pre-requisite",id:"step-1-pre-requisite",children:[{value:"Step 2. Clone the repository",id:"step-2-clone-the-repository",children:[]},{value:"Step 3. Run docker compose or install redis manually",id:"step-3-run-docker-compose-or-install-redis-manually",children:[]},{value:"Step 4. Setup and run",id:"step-4-setup-and-run",children:[]},{value:"How it works?",id:"how-it-works",children:[]}]},{value:"Step 1. Pre-requisite",id:"step-1-pre-requisite-1",children:[{value:"Step 2. Clone the repository",id:"step-2-clone-the-repository-1",children:[]},{value:"Step 3. Copy file and set proper data inside",id:"step-3-copy-file-and-set-proper-data-inside",children:[]},{value:"Step 4. Install dependencies",id:"step-4-install-dependencies",children:[]},{value:"Step 5. Run docker compose or install redis manually",id:"step-5-run-docker-compose-or-install-redis-manually",children:[]},{value:"Step 6. Deployment",id:"step-6-deployment",children:[]}]},{value:"Step 1. Pre-requisite",id:"step-1-pre-requisite-2",children:[{value:"Step 2. Clone the repository",id:"step-2-clone-the-repository-2",children:[]},{value:"Step 3. Run docker compose or install redis manually",id:"step-3-run-docker-compose-or-install-redis-manually-1",children:[]},{value:"Step 4. Setting up an environmental variable",id:"step-4-setting-up-an-environmental-variable",children:[]},{value:"4. Setup and run",id:"4-setup-and-run",children:[]}]}],b={toc:p};function d(e){var t=e.components,c=Object(r.a)(e,["components"]);return Object(i.b)("wrapper",Object(n.a)({},b,c,{components:t,mdxType:"MDXLayout"}),Object(i.b)("p",null,Object(i.b)("img",{alt:"My Image",src:a(215).default})),Object(i.b)("p",null,"Rate limiting is a mechanism that many developers may have to deal with at some point in their life. It\u2019s useful for a variety of purposes like sharing access to limited resources or limit the number of requests made to an API endpoint and respond with a 429 status code. In this tutorial, we will see how to implement Rate Limiting using various programming languages:"),Object(i.b)(l.a,{defaultValue:"Python",values:[{label:"Python",value:"Python"},{label:"NodeJS",value:"NodeJS"},{label:"Java",value:"Java"}],mdxType:"Tabs"},Object(i.b)(o.a,{value:"Python",mdxType:"TabItem"},Object(i.b)("h2",{id:"step-1-pre-requisite"},"Step 1. Pre-requisite"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Python "),Object(i.b)("li",{parentName:"ul"},"Docker"),Object(i.b)("li",{parentName:"ul"},"Docker Compose")),Object(i.b)("h3",{id:"step-2-clone-the-repository"},"Step 2. Clone the repository"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"git clone https://github.com/redis-developer/redis-rate-limiting-python.git\n")),Object(i.b)("h3",{id:"step-3-run-docker-compose-or-install-redis-manually"},"Step 3. Run docker compose or install redis manually"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"docker network create global\ndocker-compose up -d --build\n")),Object(i.b)("p",null," If you install redis manually open django-backend/configuration folder and copy ",Object(i.b)("inlineCode",{parentName:"p"},".env.example")," to create ",Object(i.b)("inlineCode",{parentName:"p"},".env"),". And provide the values for environment variables"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"- REDIS_HOST: Redis server host\n- REDIS_PORT: Redis server port\n- REDIS_DB: Redis server db index\n- REDIS_PASSWORD: Redis server password\n")),Object(i.b)("h3",{id:"step-4-setup-and-run"},"Step 4. Setup and run"),Object(i.b)("p",null,"Install python, pip and venv (on mac: ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://installpython3.com/mac/"}),"https://installpython3.com/mac/"),")"),Object(i.b)("p",null,"Use python version: 3.8"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"python3 -m venv venv\nsource ./venv/bin/activate\npip3 install -r requirements.txt\npython3 manage.py collectstatic\npython3 manage.py runserver\n")),Object(i.b)("p",null,"Step 5. Accessing the rate limiting app"),Object(i.b)("p",null,Object(i.b)("img",{alt:"Rate Limiting",src:a(215).default})),Object(i.b)("h3",{id:"how-it-works"},"How it works?"),Object(i.b)("h4",{id:"how-the-data-is-stored"},"How the data is stored:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"The AAPL's details - market cap of 2,6 triillions and USA origin - are stored in a hash like below:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),' HSET "company:AAPL" symbol "AAPL" market_cap "2600000000000" country USA\n'))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"The Ranks of AAPL of 2,6 trillions are stored in a ZSET."),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," ZADD  companyLeaderboard 2600000000000 company:AAPL\n")))),Object(i.b)("h4",{id:"how-the-data-is-accessed"},"How the data is accessed:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Top 10 companies:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," ZREVRANGE companyLeaderboard 0 9 WITHSCORES\n"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"All companies:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," ZREVRANGE companyLeaderboard 0 -1 WITHSCORES\n"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Bottom 10 companies:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," ZRANGE companyLeaderboard 0 9 WITHSCORES\n"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Between rank 10 and 15:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," ZREVRANGE companyLeaderboard 9 14 WITHSCORES\n"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Show ranks of AAPL, FB and TSLA:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," ZREVRANGE  companyLeaderBoard company:AAPL company:FB company:TSLA\n"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Adding 1 billion to market cap of FB company:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),' ZINCRBY companyLeaderBoard 1000000000 "company:FB"\n'))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Reducing 1 billion of market cap of FB company:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),' ZINCRBY companyLeaderBoard -1000000000 "company:FB"\n'))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Companies between 500 billion and 1 trillion:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," ZCOUNT companyLeaderBoard 500000000000 1000000000000\n"))),Object(i.b)("li",{parentName:"ul"},Object(i.b)("p",{parentName:"li"},"Companies over a Trillion:"),Object(i.b)("pre",{parentName:"li"},Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," ZCOUNT companyLeaderBoard 1000000000000 +inf\n"))))),Object(i.b)(o.a,{value:"NodeJS",mdxType:"TabItem"},Object(i.b)("h2",{id:"step-1-pre-requisite-1"},"Step 1. Pre-requisite"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Node - v12.19.0"),Object(i.b)("li",{parentName:"ul"},"NPM - v6.14.8"),Object(i.b)("li",{parentName:"ul"},"Docker - v19.03.13 (optional)")),Object(i.b)("h3",{id:"step-2-clone-the-repository-1"},"Step 2. Clone the repository"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"git clone https://github.com/redis-developer/basic-redis-rate-limiting-demo-nodejs/\n\n")),Object(i.b)("h3",{id:"step-3-copy-file-and-set-proper-data-inside"},"Step 3. Copy file and set proper data inside"),Object(i.b)("p",null,"Copy .env.example to .env and make the changes as per your environment"),Object(i.b)("h3",{id:"step-4-install-dependencies"},"Step 4. Install dependencies"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"npm cache clean && npm install\n")),Object(i.b)("h3",{id:"step-5-run-docker-compose-or-install-redis-manually"},"Step 5. Run docker compose or install redis manually"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"}),"docker network create global\ndocker-compose up -d --build\n``\n\n```bash\nnpm run dev\n\n")),Object(i.b)("h3",{id:"step-6-deployment"},"Step 6. Deployment"),Object(i.b)("p",null,"To make deploys work, you need to create free account in ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://redislabs.com/try-free/"}),"https://redislabs.com/try-free/")," and get Redis' instance informations - REDIS_ENDPOINT_URI and REDIS_PASSWORD. You must pass them as environmental variables.")),Object(i.b)(o.a,{value:"Java",mdxType:"TabItem"},Object(i.b)("h2",{id:"step-1-pre-requisite-2"},"Step 1. Pre-requisite"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},"Java"),Object(i.b)("li",{parentName:"ul"},"Docker"),Object(i.b)("li",{parentName:"ul"},"Docker Compose")),Object(i.b)("h3",{id:"step-2-clone-the-repository-2"},"Step 2. Clone the repository"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"https://github.com/redis-developer/basic-rate-limiting-demo-java\n")),Object(i.b)("h3",{id:"step-3-run-docker-compose-or-install-redis-manually-1"},"Step 3. Run docker compose or install redis manually"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"docker network create global\ndocker-compose up -d --build\n")),Object(i.b)("h3",{id:"step-4-setting-up-an-environmental-variable"},"Step 4. Setting up an environmental variable"),Object(i.b)("p",null,"Open directory server (cd server): copy .env.example to create .env",Object(i.b)("br",{parentName:"p"}),"\n","And provide the values for environment variables (if needed)"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"- REDIS_URL: Redis server url\n- REDIS_HOST: Redis server host\n- REDIS_PORT: Redis server port\n- REDIS_DB: Redis server db index\n- REDIS_PASSWORD: Redis server password\n")),Object(i.b)("h3",{id:"4-setup-and-run"},"4. Setup and run"),Object(i.b)("p",null,"Install gradle (on mac: ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://gradle.org/install/"}),"https://gradle.org/install/"),")"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{}),"brew install gradle\n")),Object(i.b)("p",null,"Install JDK (on mac: ",Object(i.b)("a",Object(n.a)({parentName:"p"},{href:"https://docs.oracle.com/javase/10/install/installation-jdk-and-jre-macos.htm"}),"https://docs.oracle.com/javase/10/install/installation-jdk-and-jre-macos.htm"),")"),Object(i.b)("pre",null,Object(i.b)("code",Object(n.a)({parentName:"pre"},{className:"language-sh"}),"cd server\nexport $(cat .env | xargs)\n./gradlew build\n./gradlew run\n")),Object(i.b)("p",null,"Point your browser to http://IP:5000 and you will be able to select various requests per second option on the screen as shown below:"),Object(i.b)("p",null,Object(i.b)("img",{alt:"Rate Limiter",src:a(355).default})),Object(i.b)("p",null,"As shown in the above example, the server will allow sending max 10 API requests within a 10 second window.If you send more than that, all additional requests will be blocked"))))}d.isMDXComponent=!0},164:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(162),l=a(171);a(163),a(55);t.a=function(e){var t=r.a.useState(!1),a=t[0],n=t[1];return r.a.createElement("div",{className:"ri-container"},r.a.createElement("div",{className:"ri-description-short"},r.a.createElement("div",{className:"ri-icon"},r.a.createElement("span",{className:"fe fe-zap"})),r.a.createElement("div",{className:"ri-detail"},r.a.createElement("div",{className:"ri-title"},r.a.createElement("a",{href:e.page},e.title)),r.a.createElement("div",{className:"ri-description"},e.description,r.a.Children.count(e.children)>0&&r.a.createElement("span",{className:"ri-more fe fe-more-horizontal",onClick:function(){return n(!a)}})))),a&&r.a.createElement("div",{className:"ri-description-long"},r.a.createElement(i.a,{components:l.a},e.children)))}},166:function(e,t,a){"use strict";var n=a(0),r=a(167);t.a=function(){var e=Object(n.useContext)(r.a);if(null==e)throw new Error("`useUserPreferencesContext` is used outside of `Layout` Component.");return e}},167:function(e,t,a){"use strict";var n=a(0),r=Object(n.createContext)(void 0);t.a=r},168:function(e,t,a){"use strict";var n=a(0),r=a.n(n),i=a(166),l=a(165),o=a(56),c=a.n(o),s=37,p=39;t.a=function(e){var t=e.lazy,a=e.block,o=e.defaultValue,b=e.values,d=e.groupId,m=e.className,u=Object(i.a)(),O=u.tabGroupChoices,j=u.setTabGroupChoices,h=Object(n.useState)(o),v=h[0],N=h[1],g=n.Children.toArray(e.children);if(null!=d){var y=O[d];null!=y&&y!==v&&b.some((function(e){return e.value===y}))&&N(y)}var f=function(e){N(e),null!=d&&j(d,e)},S=[];return r.a.createElement("div",null,r.a.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:Object(l.a)("tabs",{"tabs--block":a},m)},b.map((function(e){var t=e.value,a=e.label;return r.a.createElement("li",{role:"tab",tabIndex:0,"aria-selected":v===t,className:Object(l.a)("tabs__item",c.a.tabItem,{"tabs__item--active":v===t}),key:t,ref:function(e){return S.push(e)},onKeyDown:function(e){!function(e,t,a){switch(a.keyCode){case p:!function(e,t){var a=e.indexOf(t)+1;e[a]?e[a].focus():e[0].focus()}(e,t);break;case s:!function(e,t){var a=e.indexOf(t)-1;e[a]?e[a].focus():e[e.length-1].focus()}(e,t)}}(S,e.target,e)},onFocus:function(){return f(t)},onClick:function(){f(t)}},a)}))),t?Object(n.cloneElement)(g.filter((function(e){return e.props.value===v}))[0],{className:"margin-vert--md"}):r.a.createElement("div",{className:"margin-vert--md"},g.map((function(e,t){return Object(n.cloneElement)(e,{key:t,hidden:e.props.value!==v})}))))}},169:function(e,t,a){"use strict";var n=a(3),r=a(0),i=a.n(r);t.a=function(e){var t=e.children,a=e.hidden,r=e.className;return i.a.createElement("div",Object(n.a)({role:"tabpanel"},{hidden:a,className:r}),t)}},215:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/ratelimiting-0a76b60e4b3861e1190062d5029b86d9.png"},355:function(e,t,a){"use strict";a.r(t),t.default=a.p+"assets/images/ratelimiter2-f82968ae0a0ba7ec00ff3062c7663e54.png"}}]);