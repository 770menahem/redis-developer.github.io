<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redis Developer Hub Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redis Developer Hub Blog Atom Feed">
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-W8Z6BLQ",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script><title data-react-helmet="true">Recommendations with RedisGraph | Redis Developer Hub</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="/img/share.png"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Recommendations with RedisGraph | Redis Developer Hub"><meta data-react-helmet="true" name="description" content="Author: Brian Sam-Bodden"><meta data-react-helmet="true" property="og:description" content="Author: Brian Sam-Bodden"><meta data-react-helmet="true" property="og:url" content="https://developer.redis.com/develop/java/redis-and-spring-course/lesson_8"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://fonts.gstatic.com"><link data-react-helmet="true" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&amp;family=Roboto+Mono:wght@400;500;600;700&amp;display=swap" rel="stylesheet"><link data-react-helmet="true" href="/css/redis-sitesearch.css" rel="stylesheet"><link data-react-helmet="true" href="/css/redis-sitesearch-overrides.css" rel="stylesheet"><link data-react-helmet="true" rel="canonical" href="https://developer.redis.com/develop/java/redis-and-spring-course/lesson_8"><link rel="stylesheet" href="/styles.e96f0bb4.css">
<link rel="stylesheet" href="/main.c464a57b.css">
<link rel="preload" href="/styles.bad32c93.js" as="script">
<link rel="preload" href="/runtime~main.7684e8e3.js" as="script">
<link rel="preload" href="/main.ae08f34a.js" as="script">
<link rel="preload" href="/1.e8f62691.js" as="script">
<link rel="preload" href="/2.8f55b8f6.js" as="script">
<link rel="preload" href="/3.a8ccddba.js" as="script">
<link rel="preload" href="/1be78505.660325e5.js" as="script">
<link rel="preload" href="/935f2afb.fb72f3bd.js" as="script">
<link rel="preload" href="/17896441.7af6f028.js" as="script">
<link rel="preload" href="/13155904.c4ad0ecb.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W8Z6BLQ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg width="24" height="18" xmlns="http://www.w3.org/2000/svg"><g stroke="#FFFFFF" stroke-width="1.65" fill="none" fill-rule="evenodd" stroke-dasharray="4.4" stroke-linecap="round" stroke-linejoin="round"><path d="M1 16.95h24.2M1 9.25h24.2M1 1.55h24.2"></path></g></svg></div><a class="navbar__brand" href="/"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar__items navbar__items--right"><div id="redis-sitesearch" class="redis-sitesearch redis-sitesearch-inline"><input class="redis-sitesearch-input"><div class="redis-sitesearch-result-list-wrapper"><ul class="redis-sitesearch-result-list"></ul><div class="redisearch-logo"></div></div></div><a class="navbar__item navbar__link" href="/create/rediscloud">Get started</a><a href="https://launchpad.redis.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Redis Launchpad</a><a href="https://redis.com/try-free/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Try Free</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/create/rediscloud">Get started</a></li><li class="menu__list-item"><a href="https://launchpad.redis.com" target="_blank" rel="noopener noreferrer" class="menu__link">Redis Launchpad</a></li><li class="menu__list-item"><a href="https://redis.com/try-free/" target="_blank" rel="noopener noreferrer" class="menu__link">Try Free</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Create</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/redis-stack">Redis Stack</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/rediscloud">Redis Enterprise Cloud</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on Heroku</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/portal">Redis on Heroku</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/herokujava">How to deploy a Java based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/herokunodejs">How to deploy a NodeJS based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/herokupython">How to deploy a Python based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/ratelimiting-go">How to deploy a Redis Rate Limiting application on Heroku</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/herokuruby">How to deploy a Ruby based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/herokugo">How to deploy a Go based application on Heroku using Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on Azure Cache</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/portal">Redis on Azure Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/terraform-simple">Redis Enterprise with Terraform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/terraform-private-endpoint">Azure Cache for Redis Enterprise using Terraform with Private Link</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/gcp">Redis on Google Cloud</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on AWS</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws/redis-on-aws">Redis on AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws/slackbot">Building a Slack Bot using AWS S3 and RediSearch from scratch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws/terraform">Deploy and Manage Redis Database on AWS using Terraform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws/bidding-on-aws">Building a Real-Time Bidding Platform using NodeJS, AWS Lambda and Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws/import/database-migration-aws-elasticache-redis-enterprise-cloud/">Online Data Migration from AWS Elasticache to Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws/chatapp">Building a Real-Time Chat application on AWS using Python and Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws/analytics-using-aws">Building an Analytics Dashboard using NodeJS, Redis and AWS</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on Docker</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/docker/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/docker/redis-on-docker">Redis on Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/docker/nodejs-nginx-redis">Node.js, Nginx, Redis and Docker</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/kubernetes/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/kubernetes/kubernetes-gke">Redis on Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/kubernetes/kubernetes-operator">Kubernetes Operator: What It Is and Why You Should Really Care About It</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/homebrew/">Redis on Mac</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/windows">Redis on Windows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/from-source/">Redis from Source</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/jenkins">Redis using Jenkins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/openshift">Redis on Red Hat OpenShift Container Platform</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis using Netlify</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/netlify/getting-started-with-netlify">Getting Started with Netlify and Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/netlify/deploy-docusaurus-to-netlify">Deploy Docusaurus to Netlify in 5 Minutes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis using Vercel</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/vercel">Getting Started with Vercel and Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis using Cloud Run</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/cloudrun">Getting Started with Google Cloud Run and Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis using Azure Functions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azurefunctions">Getting Started with Azure Functions and Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis using Portainer</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/portainer">Getting Started with Portainer and Redis</a></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Develop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop">Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Java</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java">Overview</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Spring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/spring">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Redis OM Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/redis-om/redis-om-spring">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/redis-om/redis-om-spring-json">Working with JSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/redis-om/redis-om-spring-hash">Working with Hashes</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Redis and Spring Course</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_1">Up and Running</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_2">Spring Data Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_3">Mapping &amp; Repositories</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_4">User Roles &amp; Secondary Indexes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_5">Books, Categories &amp; The Catalog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_6">Domain Models w/ RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_7">Search w/ RediSearch</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_8">Recommendations w/ RedisGraph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/java/redis-and-spring-course/lesson_9">Caching w/ Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Rate Limiting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Fixed Window</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting/fixed-window">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting/fixed-window/reactive">Reactive Implementation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting/fixed-window/reactive-lua">Atomicity with Lua</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting/fixed-window/reactive-gears">Atomicity with Gears</a></li></ul></li></ul></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/C/">C</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Node.js</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/gettingstarted">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Node.js Crash Course</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/node-crash-course">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/welcome">Welcome</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/whatisredis">What is Redis?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/redisandnodejs">Redis and Node.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/introducingredisinsight">Introducing RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/sampleapplicationoverview">Sample Application Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/runningtheapplication">Running the Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/domainobjectswithhashes">Domain Objects with Hashes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/introductiontomodules">Introduction to Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/redisjson">RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/redisearch">RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/checkinswithstreams">Checkins with Streams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/managingsuccess">Managing Success</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/caching">Caching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/sessionstorage">Session Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/advancedstreams">Advanced Streams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/redisbloom">RedisBloom</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/coursewrapup">Wrap Up</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/redis-om">Redis OM for Node.js</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Python</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/python/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/python/fastapi">Redis with FastAPI</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">.NET</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">ASP.NET Core</a><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Rate Limiting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/aspnetcore/rate-limiting/fixed-window">Fixed Window Rate Limiting app using ASP.NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/aspnetcore/rate-limiting/sliding-window">Sliding Window Rate Limiting app  using ASP.NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/aspnetcore/rate-limiting/middleware">Rate Limiting Middleware</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Caching</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/aspnetcore/rate-limiting/fixed-window">Basic API Caching using ASP.NET Core</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis OM Dotnet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/add-and-retrieve-objects">Add and Retrieve Objects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/searching/creating-an-index">Creating an Index</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Querying</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/simple-text-queries">Simple Text Queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/searching/numeric-queries">Numeric Queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/searching/geo-filters">Geo Filters</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Aggregations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/aggregations">Aggregations Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/aggregations/apply-functions">Apply Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/aggregations/groups/groups">Grouping and Reductions</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Streams</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/streams/stream-basics">Using Redis Streams with .NET</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Blocking Reads</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/streams/blocking-reads">Blocking Stream Reads</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/streams/blocking-reads/service-stack">Blocking Stream Reads with ServiceStack.Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/streams/blocking-reads/cs-redis">Blocking Stream Reads with CSRedis</a></li></ul></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/golang/">Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/ruby/">Ruby</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/php/">Php</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/deno/">Deno</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Explore</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/what-is-redis">What is Redis?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/import/">Import Data into a Redis database</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisInsight v2.x</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2/getting-started">Getting Started with RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2/windows">How to run RedisInsight on Windows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2/browser">Visualize Redis Database keys using the RedisInsight Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2/profiler">RedisInsight Profiler Tool - Analyze Your Redis Commands Using Redis Monitor Command</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2/redisearch">Perform Database Search and Analytics using the RediSearch Plugin in RedisInsight v2.0</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisInsight v1.x</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/getting-started">Getting Started with RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/browser">Visualize Redis database keys using RedisInsight Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/slowlog">Debug Redis using RedisInsight Slowlog Debugging Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/memoryanalyzer">Optimize &amp; Analyze Redis using RedisInsight Memory Analyzer Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/cluster">Manage Your Redis Cluster using RedisInsight Cluster Management Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/streams">Use Redis Streams Consumer Groups with RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/profiler">RedisInsight Profiler Tool - Analyze Your Redis Commands Using Redis Monitor Command</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisgraph">Query, Visualize and Manipulate Graphs using RedisGraph Browser Visualization Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisgears">Write Your Serverless Redis function using RedisGears Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redistimeseries">Manage Redis time-series data using RedisTimeSeries Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisearch">Perform Database Search and Analytics using RediSearch Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/autodiscover">Utilize Elasticache Auto Discovery For Redis with RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/usinghelm">Installing RedisInsight using Helm</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisdatasource">Redis Data Source for Grafana</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisexplorer">Grafana Dashboards for Redis Enterprise Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/datadog">Redis Enterprise Observability with Datadog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redismod">RedisMod</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/riot">RIOT</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Operate</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Continuous Integration/Deployment</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/continuous-integration-continuous-deployment">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/continuous-integration-continuous-deployment/jenkins">Redis using Jenkins</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/continuous-integration-continuous-deployment/argocd">Redis using Argo CD</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Observability</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/observability">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/observability/redisdatasource">Redis Data Source for Grafana</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/observability/redisexplorer">Grafana Dashboards for Redis Enterprise Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/observability/datadog">Redis Enterprise Observability with Datadog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/observability/prometheus">Using RedisTimeSeries with Prometheus and Grafana</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Provisioning</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/provisioning">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/provisioning/terraform">Deploy and Manage Redis Database on AWS using Terraform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/provisioning/azure-cache-terraform">Azure Cache for Redis Enterprise using Terraform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/provisioning/azure-cache-terraform-private">Azure Cache for Redis Enterprise using Terraform with Private Link</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Orchestration</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/orchestration">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/orchestration/docker/">Redis on Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/docker/nodejs-nginx-redis">Node.js, Nginx, Redis and Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/orchestration/kubernetes/">Redis on Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/operate/orchestration/kubernetes-operator">Kubernetes Operator: What It Is and Why You Should Really Care About It</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">HowTos &amp; Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisearch">RediSearch Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisJSON Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/getting-started">Storing and Querying JSON documents</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-python">RedisJSON and Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-nodejs">RedisJSON and Node.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-ruby">RedisJSON and Ruby</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-go">RedisJSON and Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-java">RedisJSON and Java</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-redisinsight">RedisJSON using RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/storing-complex-json-document">Storing and retrieving Nested JSON document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/jsonind-document">Indexing JSON document using RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/redisjson-cheatsheet">RedisJSON CheatSheet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/shoppingcart">How to build a Shopping cart app using NodeJS and RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/storing-json-using-nodejs">Storing and retrieving JSON documents using Node.js</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisTimeSeries Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/getting-started">Storing and Querying Time Series data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/using-python">RedisTimeSeries and Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/using-dotnet">Using RedisTimeSeries with .NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/using-go">RedisTimeSeries and Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/using-prometheus">Using RedisTimeSeries with Prometheus and Grafana</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisGraph Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/getting-started">Getting Started with RedisGraph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/explore-python-code">Explore Python Codebase using RedisGraph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-redisinsight">RedisGraph using RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-dotnet">RedisGraph and .NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-python">RedisGraph and Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-ruby">RedisGraph and Ruby</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-javascript">RedisGraph and JavaScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-go">RedisGraph and Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-rust">RedisGraph and Rust</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/redisgraphmovies">Building Movies database app using RedisGraph &amp; NodeJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/csvtograph">Building RedisGraph databases from CSV inputs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis Bloom Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisbloom">Probabilistic data structures using Redis Stack</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisbloom/with-dotnet/redisbloom-withdotnet">Using RedisBloom with .NET</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgears">RedisGears Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisAI Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisai/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisai/getting-started">RedisAI Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisai/market-basket-analysis">Market-Basket Analysis using RedisAI and RedisGears</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/leaderboard">How to build a Real-Time Leaderboard app Using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/ratelimiting">How to build a Rate Limiter using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/caching">How to cache REST API responses Using Redis &amp; NodeJS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">How to list &amp; search Movies database using RediSearch</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/getting-started">1. Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/install">2. Install Redisearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/create">3. Create Index</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/query">4. Query Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/manage">5. Manage Index</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/import">6. Import datasets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/querymovies">7. Query Movies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/aggregation">8. Aggregation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/advancedoption">9. Advanced Option</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/sampleapp">10. Sample Application</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/chatapp">How to build a Chat application using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/frauddetection">How to build a Fraud Detection System using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraphmovies">Building Movies database app using RedisGraph and NodeJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/nlp">Building a Pipeline for Natural Language Processing using RedisGears</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/hackernews">How to build a HackerNews Clone using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/antipatterns/">Redis Anti-Patterns Every Developer Should Avoid</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/socialnetwork/">Building a Social Network Application using RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/security/">How to Use SSL/TLS With Redis Enterprise</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/analytics">Building an Analytics dashboard app using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/popupstore">Building a Popup Store application using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/herokunodejs">How to build a NodeJS based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/herokupython">How to build a Python based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/herokujava">How to build a Java based application on Heroku using Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Get Involved</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/devcember/">DEVcember</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Hacktoberfest 2021</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hacktoberfest/">Start Here</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hacktoberfest/stories/lara-aasem">Lara&#x27;s Hacktoberfest at Redis Story</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hacktoberfest/stories/vincent-aceto">Vincent&#x27;s Hacktoberfest at Redis Story</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/discord/">Discord</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/redis-live/">Redis Live</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><header><h1 class="docTitle_cWlf">Recommendations with RedisGraph</h1></header><div class="markdown"><p>Author: <a href="https://twitter.com/bsbodden" target="_blank" rel="noopener noreferrer">Brian Sam-Bodden</a></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="objectives"></a>Objectives<a class="hash-link" href="#objectives" title="Direct link to heading">#</a></h3><p>Build a simple but powerful graph-based recommendation engine in the Redi2Read application.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="agenda"></a>Agenda<a class="hash-link" href="#agenda" title="Direct link to heading">#</a></h3><p>In this lesson, students will learn:</p><ul><li>How to use RedisGraph in a Spring Boot application to construct a Graph from model data using the JRedisGraph client library.</li><li>How to query data using the Cypher query language.
If you get stuck:</li><li>The progress made in this lesson is available on the redi2read github repository at <a href="https://github.com/redis-developer/redi2read/tree/course/milestone-8" target="_blank" rel="noopener noreferrer">https://github.com/redis-developer/redi2read/tree/course/milestone-8</a></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="graphs"></a>Graphs<a class="hash-link" href="#graphs" title="Direct link to heading">#</a></h3><p>Graph databases are composed of nodes and relationships. These databases excel at managing highly connected data.
Nodes represent entities (party, place, thing, category, moment-in-time) related to other entities.
Relationships connect nodes. They represent an association between nodes that are important to your domain.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="redis-graph"></a>Redis Graph<a class="hash-link" href="#redis-graph" title="Direct link to heading">#</a></h3><p>Redis Graph is a low-latency graph database based on the property graph model built as a Redis module.
Like all graphs, a property graph has nodes and relationships. However, it adds extra expressiveness by providing:</p><ul><li>Nodes: Graph data entities</li><li>Relationships: Connect nodes (has direction and a type)</li><li>Properties: Stores data in key-value pairs in nodes and relationships</li><li>Labels: Groups nodes and relationships (optional)</li></ul><p>Redis Graph meets the two most essential requirements of a graph database:
Native Graph Storage: Uses a Redis-native optimized graph data structure (sparse adjacency matrices).
Native Graph Processing: Index-free adjacency and linear algebra to query the graph.
It supports a large subset of the Cypher Query Language, an open standard supported by several graph databases, the Cypher Graph Query Language.
The Cypher Query Language is a SQL-inspired pattern-matching language with an easy to grasp visual aspect due to its use of ASCII-Art to easily visual graph relationships in text. The specification is becoming an industry standard among graph database vendors (see openCypher).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="nodes"></a>Nodes<a class="hash-link" href="#nodes" title="Direct link to heading">#</a></h3><p>Nodes are enclosed by parenthesis. For example:
<code>()</code></p><p>It is the simplest of nodes; an anonymous node (with no label or variable), as a pattern-matching entity, it will match any node in the database.
<code>(:Actor)</code></p><p>Represents a node under the label “Actor”; you can think of it as the node’s class.
<code>(a:Actor)</code></p><p>In this example, “a” is an alias for the node. Think of it as a variable that you can use in a query, just like in SQL.
<code>(a:Actor {name:&#x27;Kathryn Hahn&#x27;})</code></p><p>The JSON-looking object in curly brackets is a node property. The properties are attached to the node upon creation. When used in a query, they serve as pattern matching.
Relationships
Relationships are represented by arrows (--&gt; or &lt;--) between two nodes. The type of relationship is enclosed in squared brackets.
<code>(a:Actor {name:&#x27;Kathryn Hahn&#x27;})-[:ACTS]-&gt;(s:Show {name:&#x27;WandaVision&#x27;})</code></p><p>The above snippet could be used to create the relationship if used with the GRAPH.CREATE method, for example. If the nodes did not exist, they would be created, or if they existed, it would just use the node properties to pattern match.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="redisinsight-a-visual-management-tool-for-redis"></a>RedisInsight: A Visual Management Tool for Redis<a class="hash-link" href="#redisinsight-a-visual-management-tool-for-redis" title="Direct link to heading">#</a></h3><p>Until now, we have been using the Redis CLI, curl, and the output of our Java programs to interact with Redis.</p><p>If there is one place where we can use visualization is with graph data. RedisInsight is a free product from Redis that provides an intuitive graphical user interface for managing Redis databases.
RedisInsight also supports some popular Redis modules, and we&#x27;ll use it in this lesson to visualize our graphs.
If you want to get the best possible understanding of the materials in this chapter, please download and install RedisInsight.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="a-warm-up-with-cypher"></a>A warm-up with Cypher<a class="hash-link" href="#a-warm-up-with-cypher" title="Direct link to heading">#</a></h3><p>Try in the Redis CLI
Ok, enough theory, let’s fire up the Redis CLI and try some graph making and querying (and later visualizing in RedisInsight).
Let’s create a standalone node for an Actor:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CREATE (:Actor {name: &#x27;Kathryn Hahn&#x27;, nick: &#x27;ka&#x27;})&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Labels added: 1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Nodes created: 1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Properties set: 2&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">And a standalone node </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> a TV show:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CREATE (:Show {name: &#x27;WandaVision&#x27;, nick: &#x27;wv&#x27;})&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Labels added: 1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Nodes created: 1&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Properties set: 2&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now let’s join them with a relationship of type <code>:ACTS</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor {nick: &#x27;ka&#x27;}), (s:Show {nick: &#x27;wv&#x27;}) CREATE (a)-[:ACTS]-&gt;(s)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Relationships created: 1&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The MATCH keyword indicates a pattern matching operation. You can have multiple patterns in a command separated list in a single MATCH or multiple MATCH lines. Variables are used to “join” multiple patterns.
Notice that the Redis Graph Cypher command starts with:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY key-of-the-graph cypher-query</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>First, let’s see what are the unique labels (classes) in the graph:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GRAPH.QUERY </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;imdb-grf&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;match (n) return distinct labels(n)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;labels(n)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Actor&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Show&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Movie&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In RedisInsight:</p><p><img alt="RedisInsight" src="/assets/images/redis-insight-34e1d2647f2fdf3c20170d9447a6059c.png"></p><p>As expected, the unique labels are “Actor,” “Movie,” and “Show.”
Now, execute the commands below, and then we can ask some questions of the data using Cypher:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CREATE (:Actor {name: &#x27;Paul Bettany&#x27;, nick: &#x27;pb&#x27;})&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CREATE (:Actor {name: &#x27;Paul Rudd&#x27;, nick: &#x27;pr&#x27;})&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CREATE (:Show {name: &#x27;The Shrink Next Door&#x27;, nick: &#x27;tsnd&#x27;})&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CREATE (:Movie {name: &#x27;Iron Man&#x27;, nick: &#x27;im&#x27;})&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CREATE (:Movie {name: &#x27;Our Idiot Brother&#x27;, nick: &#x27;oib&#x27;})&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CREATE (:Movie {name: &#x27;Captain America: Civil War&#x27;, nick: &#x27;cacw&#x27;})&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor {nick: &#x27;pb&#x27;}), (s:Show {nick: &#x27;wv&#x27;}) CREATE (a)-[:ACTS]-&gt;(s)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor {nick: &#x27;pb&#x27;}), (m:Movie {nick: &#x27;im&#x27;}) CREATE (a)-[:ACTS]-&gt;(m)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor {nick: &#x27;ka&#x27;}), (m:Movie {nick: &#x27;oib&#x27;}) CREATE (a)-[:ACTS]-&gt;(m)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor {nick: &#x27;pr&#x27;}), (m:Movie {nick: &#x27;oib&#x27;}) CREATE (a)-[:ACTS]-&gt;(m)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor {nick: &#x27;pr&#x27;}), (m:Movie {nick: &#x27;cacw&#x27;}) CREATE (a)-[:ACTS]-&gt;(m)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor {nick: &#x27;pr&#x27;}), (s:Show {nick: &#x27;tsnd&#x27;}) CREATE (a)-[:ACTS]-&gt;(s)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor {nick: &#x27;ka&#x27;}), (s:Show {nick: &#x27;tsnd&#x27;}) CREATE (a)-[:ACTS]-&gt;(s)&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>What are the relationships in our graph?</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GRAPH.QUERY </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;imdb-grf&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH ()-[e]-&gt;() RETURN distinct type(e)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;type(e)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;ACTS&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Count the labels in the graph:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GRAPH.QUERY </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;imdb-grf&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (n) RETURN distinct labels(n), count(n)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;labels(n)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;count(n)&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Actor&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">integer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Movie&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">integer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Show&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">integer</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Return the name of all actors that acted in ‘The Shrink Next Door’:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GRAPH.QUERY imdb-grf </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH (a:Actor)-[:ACTS]-&gt;(:Show {name:&#x27;The Shrink Next Door&#x27;}) RETURN a.name&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a.name&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Kathryn Hahn&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Paul Rudd&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Find any two actors that worked together in a movie:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GRAPH.QUERY </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;imdb-grf&quot;</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;MATCH                  (a1:Actor)-[:ACTS]-&gt;(m:Movie)&lt;-[:ACTS]-(a2:Actor)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">WHERE a1 &lt;&gt; a2 AND id(a1) &gt; id(a2)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token string" style="color:rgb(195, 232, 141)">RETURN m.name, a1.name, a2.name&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;m.name&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a1.name&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;a2.name&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Our Idiot Brother&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Paul Rudd&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      </span><span class="token number" style="color:rgb(247, 140, 108)">3</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Kathryn Hahn&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>That last query gives us a glimpse into the power of the Cypher Query Language. We can graphically draw the connections between the two actors, remove any duplicated (the permutations problem) by making sure we don’t match on the same node (Paul Rudd and Paul Rudd) and variations of the same pair (Paul Rudd and Kathryn Hahn vs. Kathryn Hahn and Paul Rudd) by ordering the pair using the id function.
Creating the Redi2Read Graph
Now that we have a cursory understanding of Redis Graph and the Cypher Query Language, let’s build the graph that will power our recommendations in Redi2Read.
We will create a graph containing the following relationships:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">Author -</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> AUTHORED -</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Book</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Book -</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> IN -</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Category</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">User -</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> RATED -</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Book</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">User -</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> PURCHASED -</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> Book</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="using-redis-graph-in-java"></a>Using Redis Graph in Java<a class="hash-link" href="#using-redis-graph-in-java" title="Direct link to heading">#</a></h3><p>To create and query graphs in Redi2Read we will use the JRedisGraph client library for Redis Graph (<a href="https://github.com/RedisGraph/JRedisGraph" target="_blank" rel="noopener noreferrer">https://github.com/RedisGraph/JRedisGraph</a>) built on top of the popular Jedis client library (<a href="https://github.com/redis/jedis" target="_blank" rel="noopener noreferrer">https://github.com/redis/jedis</a>)
Adding the JRedisGraph dependency
In your Maven pom.xml, add the following dependency:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-xml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">dependency</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">groupId</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">com.redislabs</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">groupId</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">artifactId</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">jredisgraph</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">artifactId</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;</span><span class="token tag" style="color:rgb(255, 85, 114)">version</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain">2.3.0</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">version</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&lt;/</span><span class="token tag" style="color:rgb(255, 85, 114)">dependency</span><span class="token tag punctuation" style="color:rgb(199, 146, 234)">&gt;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="commandlinerunner"></a>CommandLineRunner<a class="hash-link" href="#commandlinerunner" title="Direct link to heading">#</a></h4><p>To create our graph we’ll use the now familiar CommandLineRunner recipe. We will keep the name of the created graph in the applications property field as shown:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">app.graphId</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">redi2read-grf</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Next, create the src/main/java/com/redislabs/edu/redi2read/boot/CreateGraph.java file and add the contents as follows:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">package com.redislabs.edu.redi2read.boot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import java.util.HashSet;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import java.util.Set;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.beans.factory.annotation.Value;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.boot.CommandLineRunner;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.core.annotation.Order;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.data.redis.core.RedisTemplate;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.stereotype.Component;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.edu.redi2read.repositories.BookRatingRepository;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.edu.redi2read.repositories.BookRepository;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.edu.redi2read.repositories.CategoryRepository;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.edu.redi2read.repositories.UserRepository;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.redisgraph.impl.api.RedisGraph;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import lombok.extern.slf4j.Slf4j;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@Component</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@Order(8)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@Slf4j</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class CreateGraph implements CommandLineRunner {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  private RedisTemplate&lt;String, String&gt; redisTemplate;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  private UserRepository userRepository;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  private BookRepository bookRepository;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  private BookRatingRepository bookRatingRepository;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  private CategoryRepository categoryRepository;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Value(&quot;${app.graphId}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  private String graphId;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Override</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  public void run(String... args) throws Exception {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!redisTemplate.hasKey(graphId)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      try (RedisGraph graph = new RedisGraph()) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // create an index for Books on id</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        graph.query(graphId, &quot;CREATE INDEX ON :Book(id)&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        graph.query(graphId, &quot;CREATE INDEX ON :Category(id)&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        graph.query(graphId, &quot;CREATE INDEX ON :Author(name)&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        graph.query(graphId, &quot;CREATE INDEX ON :User(id)&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        Set&lt;String&gt; authors = new HashSet&lt;String&gt;();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // for each category create a graph node</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        categoryRepository.findAll().forEach(c -&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          graph.query(graphId, String.format(&quot;CREATE (:Category {id: \&quot;%s\&quot;, name: \&quot;%s\&quot;})&quot;, c.getId(), c.getName()));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // for each book create a graph node</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bookRepository.findAll().forEach(b -&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          graph.query(graphId, String.format(&quot;CREATE (:Book {id: \&quot;%s\&quot;, title: \&quot;%s\&quot;})&quot;, b.getId(), b.getTitle()));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          // for each author create an AUTHORED relationship to the book</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          if (b.getAuthors() != null) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            b.getAuthors().forEach(a -&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              if (!authors.contains(a)) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                graph.query(graphId, String.format(&quot;CREATE (:Author {name: \&quot;%s\&quot;})&quot;, a));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                authors.add(a);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              graph.query(graphId, String.format(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                  &quot;MATCH (a:Author {name: \&quot;%s\&quot;}), (b:Book {id: \&quot;%s\&quot;}) CREATE (a)-[:AUTHORED]-&gt;(b)&quot;, a, b.getId()));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            b.getCategories().forEach(c -&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              graph.query(graphId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                  String.format(&quot;MATCH (b:Book {id: \&quot;%s\&quot;}), (c:Category {id: \&quot;%s\&quot;}) CREATE (b)-[:IN]-&gt;(c)&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                      b.getId(), c.getId()));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // for each user create a graph node</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        userRepository.findAll().forEach(u -&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          graph.query(graphId, String.format(&quot;CREATE (:User {id: \&quot;%s\&quot;, name: \&quot;%s\&quot;})&quot;, u.getId(), u.getName()));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          // for each of the user&#x27;s book create a purchased relationship</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          u.getBooks().forEach(book -&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            graph.query(graphId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                String.format(&quot;MATCH (u:User {id: \&quot;%s\&quot;}), (b:Book {id: \&quot;%s\&quot;}) CREATE (u)-[:PURCHASED]-&gt;(b)&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                    u.getId(), book.getId()));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        // for each book rating create a rated relationship</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        bookRatingRepository.findAll().forEach(br -&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">          graph.query(graphId,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">              String.format(&quot;MATCH (u:User {id: \&quot;%s\&quot;}), (b:Book {id: \&quot;%s\&quot;}) CREATE (u)-[:RATED {rating: %s}]-&gt;(b)&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">                  br.getUser().getId(), br.getBook().getId(), br.getRating()));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        });</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      log.info(&quot;&gt;&gt;&gt;&gt; Created graph...&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Let’s break down the graph creation:</p><ul><li>We inject the needed repositories for users, books, book rating and categories</li><li>We check if the key for the graph does not exist to prevent recreating the graph on restarts</li><li>We create 4 single property indexes for the Book id, Category id, Author name and User id. RedisGraph supports indexes for node labels. Indexes are automatically used by queries that reference any indexed properties.<ul><li>For each book category we create a node</li><li>For each book we create a node</li><li>For each author we create a node</li><li>For each book author we created a AUTHORED relationship between the author and the book</li><li>For each book we created an IN relationship with the category</li><li>For each user we create a node</li><li>For each book owned by a user we create a PURCHASED relationship</li><li>For each book rating we create a RATED relationship between the user and the book</li></ul></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="creating-the-recommendations-service"></a>Creating the Recommendations Service<a class="hash-link" href="#creating-the-recommendations-service" title="Direct link to heading">#</a></h3><p>As we did in the Search Lesson, we are going to use a Service abstraction to encapsulate the complexity of the recommendations engine.
Let’s start with the skeleton of the recommendation service. Create the src/main/java/com/redislabs/edu/redi2read/services/RecommendationService.java file and add the contents as follows:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">package com.redislabs.edu.redi2read.services;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import java.util.HashSet;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import java.util.Set;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.redisgraph.Record;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.redisgraph.ResultSet;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.redisgraph.graph_entities.Node;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.redisgraph.impl.api.RedisGraph;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.beans.factory.annotation.Value;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.stereotype.Service;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@Service</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class RecommendationService {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Value(&quot;${app.graphId}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  public String graphId;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  RedisGraph graph = new RedisGraph();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  // add magic here!</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Getting Book Recommendations From Common Purchases
Our first recommendation method will find recommendations by looking at purchases of other users that have bought some of the same books a user has in its bookshelf:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">MATCH </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">u:User </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain"> id: </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;8675309&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:PURCHASED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ob:Book</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MATCH </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">ob</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:PURCHASED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">:User</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:PURCHASED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b:Book</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">WHERE NOT </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">u</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:PURCHASED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RETURN distinct b, count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> as frequency</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ORDER BY frequency DESC</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Let’s break down the Cypher query:</p><ul><li>The anchor for the query is the User’s id, in this case ‘8675309’</li><li>On the first MATCH we look for the given user purchases</li><li>On the second MATCH we find other users that have purchase a book the user has purchased and also collect the other users books</li><li>On WHERE clause we make sure that the user doesn’t already own any of the recommended books</li><li>ON the RETURN we make sure to remove duplicates and we count how often a book has been purchased</li><li>Finally on the ORDER BY, we return the most purchased books first</li></ul><p>Running the query on RedisInsight we get graphical display in which we can navigate the relationships of the result set:</p><p><img alt="RedisInsight Query Results Graph" src="/assets/images/redis-insight-query-graph-abb7d323e5eaf895bf74cba9710affe9.png"></p><p>There is also a tabular results view that reflect the values of the RETURN clause:</p><p><img alt="RedisInsight Query Results Table" src="/assets/images/redis-insight-query-table-7c782e4b532a59ebeae26cb1eff5cb07.png"></p><p>To implement the above query in the recommendations service we can escape the query string, and we simply pass the prepared query string to JRedisGraph’s query method:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">public Set&lt;String&gt; getBookRecommendationsFromCommonPurchasesForUser(String userId) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  Set&lt;String&gt; recommendations = new HashSet&lt;String&gt;();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  String query = &quot;MATCH (u:User { id: &#x27;%s&#x27; })-[:PURCHASED]-&gt;(ob:Book) &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">               + &quot;MATCH (ob)&lt;-[:PURCHASED]-(:User)-[:PURCHASED]-&gt;(b:Book) &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">               + &quot;WHERE NOT (u)-[:PURCHASED]-&gt;(b) &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">               + &quot;RETURN distinct b, count(b) as frequency &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">               + &quot;ORDER BY frequency DESC&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ResultSet resultSet = graph.query(graphId, String.format(query, userId));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    while (resultSet.hasNext()) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Record record = resultSet.next();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Node book = record.getValue(&quot;b&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      recommendations.add(book.getProperty(&quot;id&quot;).getValue().toString());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return recommendations;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Similar to a JDBC result set, we have an iterator that returns Record objects. We extract the column of interest by its label, in the case above “b” for the Book entity. Graph Nodes like the “book” variable above are like Maps, we can get a property by its name “id” and then get the value with getValue().
Books Frequently Bought Together
To find books that are frequently bought together give an ISBN we use the query:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">MATCH </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">u:User</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:PURCHASED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b1:Book </span><span class="token punctuation" style="color:rgb(199, 146, 234)">{</span><span class="token plain">id: </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;%s&#x27;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">}</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MATCH </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b1</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:PURCHASED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">u</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:PURCHASED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">-</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b2:Book</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">MATCH rated </span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">User</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token plain">:RATED</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain">-</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">WITH b1, b2, count</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">b2</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> as freq, head</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">relationships</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">rated</span><span class="token punctuation" style="color:rgb(199, 146, 234)">))</span><span class="token plain"> as r</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">WHERE b1 </span><span class="token operator" style="color:rgb(137, 221, 255)">&lt;&gt;</span><span class="token plain"> b2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">RETURN b2, freq, avg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r.rating</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ORDER BY freq, avg</span><span class="token punctuation" style="color:rgb(199, 146, 234)">(</span><span class="token plain">r.rating</span><span class="token punctuation" style="color:rgb(199, 146, 234)">)</span><span class="token plain"> DESC</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Let&#x27;s break it down:</p><ul><li>The first MATCH find users that have the bought the target book</li><li>The second MATCH finds other books purchased by those users</li><li>The third MATCH find the ratings if any for those books</li><li>The WITH clause groups the values gathered so far, counts number of purchases of the collected books and grab the metadata from the RATED notes</li><li>The RETURN line returns the collected books, with the number of purchases and their average star rating</li></ul><p>To implement the above query in our service add the following method:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">  public Set&lt;String&gt; getFrequentlyBoughtTogether(String isbn) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    Set&lt;String&gt; recommendations = new HashSet&lt;String&gt;();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    String query = &quot;MATCH (u:User)-[:PURCHASED]-&gt;(b1:Book {id: &#x27;%s&#x27;}) &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        + &quot;MATCH (b1)&lt;-[:PURCHASED]-(u)-[:PURCHASED]-&gt;(b2:Book) &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        + &quot;MATCH rated = (User)-[:RATED]-(b2) &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        + &quot;WITH b1, b2, count(b2) as freq, head(relationships(rated)) as r &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        + &quot;WHERE b1 &lt;&gt; b2 &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        + &quot;RETURN b2, freq, avg(r.rating) &quot; //</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        + &quot;ORDER BY freq, avg(r.rating) DESC&quot;;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ResultSet resultSet = graph.query(graphId, String.format(query, isbn));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    while (resultSet.hasNext()) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Record record = resultSet.next();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      Node book = record.getValue(&quot;b2&quot;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      recommendations.add(book.getProperty(&quot;id&quot;).getValue().toString());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return recommendations;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="the-recommendations-controller"></a>The Recommendations Controller<a class="hash-link" href="#the-recommendations-controller" title="Direct link to heading">#</a></h3><p>To serve our recommendations we will expose the recommendation service using the <code>RecommendationController</code>.
Create the <code>src/main/java/com/redislabs/edu/redi2read/controllers/RecommendationController.java</code>
file and add the contents as follows:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-java codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">package com.redislabs.edu.redi2read.controllers;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import java.util.Set;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import com.redislabs.edu.redi2read.services.RecommendationService;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.beans.factory.annotation.Autowired;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.web.bind.annotation.GetMapping;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.web.bind.annotation.PathVariable;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.web.bind.annotation.RequestMapping;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">import org.springframework.web.bind.annotation.RestController;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@RestController</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">@RequestMapping(&quot;/api/recommendations&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">public class RecommendationController {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @Autowired</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  private RecommendationService recommendationService;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @GetMapping(&quot;/user/{userId}&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  public Set&lt;String&gt; userRecommendations(@PathVariable(&quot;userId&quot;) String userId) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return recommendationService.getBookRecommendationsFromCommonPurchasesForUser(userId);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  @GetMapping(&quot;/isbn/{isbn}/pairings&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  public Set&lt;String&gt; frequentPairings(@PathVariable(&quot;isbn&quot;) String isbn) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return recommendationService.getFrequentlyBoughtTogether(isbn);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You can invoke the recommendation service with a curl request like:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> --location --request GET </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;http://localhost:8080/api/recommendations/user/55214615117483454&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>or:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">curl</span><span class="token plain"> --location --request GET </span><span class="token string" style="color:rgb(195, 232, 141)">&#x27;http://localhost:8080/api/recommendations/isbn/1789610222/pairings&#x27;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/redis-developer/redis-developer/edit/master/docs/develop/java/spring/redis-and-spring-course/lesson_8/index-lesson_8.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col text--right"><em><small>Last updated on <time datetime="2021-11-25T22:12:27.000Z" class="docLastUpdatedAt_1gIo">11/25/2021</time></small></em></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/develop/java/redis-and-spring-course/lesson_7"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Search with RediSearch</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/develop/java/redis-and-spring-course/lesson_9"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Caching REST Services with Redis »</div></a></div></nav></div></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><svg width="785" height="158" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="shape"><defs><path d="M786.344 392.459c-41.822 22.164-258.313 110.84-305.056 135.477-46.742 24.637-72.163 23.812-108.246 6.57-36.082-17.24-267.334-111.664-309.156-131.377-41.822-19.713-42.642-33.657-1.64-49.271C103.25 338.265 332.86 247.94 381.243 229.875c48.383-18.065 65.604-18.065 106.605-2.473 41.003 15.614 256.674 100.996 297.676 115.785 41.002 14.791 42.642 27.912.82 49.273v-.001z" id="a"></path><mask id="b" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="785" height="331" fill="#fff"><use xlink:href="#a"></use></mask></defs><use mask="url(#b)" xlink:href="#a" transform="translate(-32 -216)" stroke="#465282" stroke-width="4" fill="none" fill-rule="evenodd" stroke-dasharray="3.637"></use></svg><img src="/img/code-2.png" class="code" alt=""><div class="row"><div class="col col--3"><div class="footer__logo-ctr"><span class="footer__logo-tagline">Made with &lt;/&gt; by</span><a href="https://redis.com/" target="_blank" rel="noopener" class="footerLogoLink_3L_r"><img loading="lazy" class="footer__logo" alt="Redis logo" src="/img/redis_logo_red_white_rgb.svg"></a></div></div><div class="col col--9"><div class="row footer__links"><div class="col col--4 footer__col"><h4 class="footer__title">Get Started</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/create/rediscloud">Create Database</a></li><li class="footer__item"><a class="footer__link-item" href="/develop/">Develop</a></li><li class="footer__item"><a class="footer__link-item" href="/explore/redisinsight/">Explore your data</a></li><li class="footer__item"><a href="https://redis.com/redis-best-practices/introduction/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Best Practices</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/create/redis-stack/">Redis Stack</a></li></ul></div><div class="col col--4 footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a href="https://redis.com/community/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community</a></li><li class="footer__item"><a href="https://university.redis.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Redis University</a></li><li class="footer__item"><a href="https://redis.io/commands" target="_blank" rel="noopener noreferrer" class="footer__link-item">Command Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/howtos">How-tos &amp; tutorials</a></li></ul></div></div></div></div><div class="footer__copyright">Copyright: © 2022 Redis. All rights reserved. Redis and the cube logo are registered trademarks of Redis Ltd.</div></div></footer></div>
<script src="/styles.bad32c93.js"></script>
<script src="/runtime~main.7684e8e3.js"></script>
<script src="/main.ae08f34a.js"></script>
<script src="/1.e8f62691.js"></script>
<script src="/2.8f55b8f6.js"></script>
<script src="/3.a8ccddba.js"></script>
<script src="/1be78505.660325e5.js"></script>
<script src="/935f2afb.fb72f3bd.js"></script>
<script src="/17896441.7af6f028.js"></script>
<script src="/13155904.c4ad0ecb.js"></script>
</body>
</html>