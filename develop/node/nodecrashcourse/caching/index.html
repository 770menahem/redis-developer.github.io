<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redis Developer Hub Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redis Developer Hub Blog Atom Feed">
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-W8Z6BLQ",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script><title data-react-helmet="true">Caching with Redis and Express Middleware | Redis Developer Hub</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="/img/share.png"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Caching with Redis and Express Middleware | Redis Developer Hub"><meta data-react-helmet="true" name="description" content="We want to provide our users with up to date weather for each of our locationsâ€¦ so we&#x27;ve partnered with a company that provides a weather API."><meta data-react-helmet="true" property="og:description" content="We want to provide our users with up to date weather for each of our locationsâ€¦ so we&#x27;ve partnered with a company that provides a weather API."><meta data-react-helmet="true" property="og:url" content="https://developer.redis.com/develop/node/nodecrashcourse/caching"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://fonts.gstatic.com"><link data-react-helmet="true" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&amp;family=Roboto+Mono:wght@400;500;600;700&amp;display=swap" rel="stylesheet"><link data-react-helmet="true" href="/css/redis-sitesearch.css" rel="stylesheet"><link data-react-helmet="true" href="/css/redis-sitesearch-overrides.css" rel="stylesheet"><link data-react-helmet="true" rel="canonical" href="https://developer.redis.com/develop/node/nodecrashcourse/caching"><link rel="stylesheet" href="/styles.68cfdffa.css">
<link rel="stylesheet" href="/main.8cbeb264.css">
<link rel="preload" href="/styles.67a137f0.js" as="script">
<link rel="preload" href="/runtime~main.900e876e.js" as="script">
<link rel="preload" href="/main.d146c69e.js" as="script">
<link rel="preload" href="/1.82c5356d.js" as="script">
<link rel="preload" href="/2.10c5caf9.js" as="script">
<link rel="preload" href="/3.9525cd79.js" as="script">
<link rel="preload" href="/1be78505.964c506b.js" as="script">
<link rel="preload" href="/935f2afb.ec62a840.js" as="script">
<link rel="preload" href="/17896441.9e18bbbf.js" as="script">
<link rel="preload" href="/f2d3ddf1.729b4e13.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W8Z6BLQ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg width="24" height="18" xmlns="http://www.w3.org/2000/svg"><g stroke="#FFFFFF" stroke-width="1.65" fill="none" fill-rule="evenodd" stroke-dasharray="4.4" stroke-linecap="round" stroke-linejoin="round"><path d="M1 16.95h24.2M1 9.25h24.2M1 1.55h24.2"></path></g></svg></div><a class="navbar__brand" href="/"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar__items navbar__items--right"><div id="redis-sitesearch" class="redis-sitesearch redis-sitesearch-inline"><input class="redis-sitesearch-input"><div class="redis-sitesearch-result-list-wrapper"><ul class="redis-sitesearch-result-list"></ul><div class="redisearch-logo"></div></div></div><a class="navbar__item navbar__link" href="/create/rediscloud">Get started</a><a href="https://redis.com/try-free/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Try Free</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/create/rediscloud">Get started</a></li><li class="menu__list-item"><a href="https://redis.com/try-free/" target="_blank" rel="noopener noreferrer" class="menu__link">Try Free</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_25T_"><div class="menu menu--responsive thin-scrollbar menu_1e9D"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1hKf" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Create</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/rediscloud">Redis Enterprise Cloud</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku">Redis on Heroku</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on Azure Cache</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/portal">Redis on Azure Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/terraform-simple">Redis Enterprise with Terraform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/terraform-private-endpoint">Azure Cache for Redis Enterprise using Terraform with Private Link</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/gcp">Redis on Google Cloud</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws">Redis on AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/docker/">Redis on Docker</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/kubernetes/">Redis on Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/homebrew/">Redis on Mac</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/windows">Redis on Windows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/from-source/">Redis from Source</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Develop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Java</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Spring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis and Spring Course</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_1">Up and Running</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_2">Spring Data Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_3">Mapping &amp; Repositories</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_4">User Roles &amp; Secondary Indexes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_5">Books, Categories &amp; The Catalog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_6">Domain Models w/ RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_7">Search w/ RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_8">Recommendations w/ RedisGraph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_9">Caching w/ Redis</a></li></ul></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/C/">C</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Node.js</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/gettingstarted">Getting Started</a></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!" tabindex="0">Node.js Crash Course</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/node-crash-course">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/welcome">Welcome</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/whatisredis">What is Redis?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/redisandnodejs">Redis and Node.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/introducingredisinsight">Introducing RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/sampleapplicationoverview">Sample Application Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/runningtheapplication">Running the Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/domainobjectswithhashes">Domain Objects with Hashes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/introductiontomodules">Introduction to Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/redisjson">RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/redisearch">RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/checkinswithstreams">Checkins with Streams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/managingsuccess">Managing Success</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/develop/node/nodecrashcourse/caching">Caching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/sessionstorage">Session Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/advancedstreams">Advanced Streams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/redisbloom">RedisBloom</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/node/nodecrashcourse/coursewrapup">Wrap Up</a></li></ul></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Python</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/python/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/python/fastapi">Redis with FastAPI</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/dotnet/">.NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/golang/">Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/ruby/">Ruby</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/develop/php/">Php</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Explore</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisInsight</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/browser">Visualize Redis database keys</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/slowlog">Debugging Redis using Slowlog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/memoryanalyzer">Manage and Optimize Redis with Memory Analyzer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/cluster">Manage Your Redis Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/streams">Using Redis Streams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/profiler">Analyze Your Redis commands using Profiler</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisgraph">Query and Manipulate Graphs using RedisGraph Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisgears">Writing Your Serverless Function using RedisGears Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redistimeseries">Managing time-series data using RedisTimeSeries Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisearch">Unified Search and Analytics using RediSearch Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/autodiscover">Autodiscover Elasticache Redis caches using RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/usinghelm">Installing RedisInsight using Helm</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisdatasource">Redis Data Source for Grafana</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redismod">RedisMod</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/riot">RIOT</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">HowTos &amp; Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisearch">RediSearch Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisJSON Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/getting-started">Getting Started with RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-python">RedisJSON and Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-nodejs">RedisJSON and NodeJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-ruby">RedisJSON and Ruby</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-go">RedisJSON with Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-java">RedisJSON with Java</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-redisinsight">RedisJSON using RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/storing-complex-json-document">Storing and retrieving Nested JSON document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/jsonind-document">Indexing JSON document using RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/redisjson-cheatsheet">RedisJSON CheatSheet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/shoppingcart">How to build a Shopping cart app using NodeJS and RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/storing-json-using-nodejs">Storing and retrieving JSON documents using NodeJS</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries">RedisTimeSeries Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph">RedisGraph Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisbloom">RedisBloom Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgears">RedisGears Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisai">RedisAI Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/leaderboard">How to build a Real-Time Leaderboard app Using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/ratelimiting">How to build a Rate Limiter using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/caching">How to cache REST API responses Using Redis &amp; NodeJS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">How to list &amp; search Movies database using RediSearch</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/getting-started">1. Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/install">2. Install Redisearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/create">3. Create Index</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/query">4. Query Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/manage">5. Manage Index</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/import">6. Import datasets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/querymovies">7. Query Movies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/aggregation">8. Aggregation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/advancedoption">9. Advanced Option</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/sampleapp">10. Sample Application</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/chatapp">How to build a Chat application using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/frauddetection">How to build a Fraud Detection System using RedisGears and RedisBloom</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraphmovies">Building Movies database app using RedisGraph and NodeJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/nlp">Building a Pipeline for Natural Language Processing using RedisGears</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/hackernews">How to build a HackerNews Clone using RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/antipatterns/">12 Redis Anti-Patterns Every Developer Should Avoid</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/security/">How to Use SSL/TLS With Redis Enterprise</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/analytics">Building an Analytics dashboard app using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/popupstore">Building a Popup Store application using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/herokunodejs">How to build NodeJS based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/herokupython">How to build Python based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/herokujava">How to build Java based application on Heroku using Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Get Involved</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/discord/">Discord</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/redis-live/">Redis Live</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Caching with Redis and Express Middleware</h1></header><div class="markdown"><div class="text--center"><iframe width="560" height="315" src="https://www.youtube.com/embed/UtB_eHmnz1Y" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe></div><p>We want to provide our users with up to date weather for each of our locationsâ€¦ so we&#x27;ve partnered with a company that provides a weather API.</p><p>Our use of this API is metered and rate limited, so ideally we don&#x27;t want to keep making the same requests to it over and over again.  This is wasteful, could cost us money, and will slow down responses to our users.</p><p>Redis can be used as a cache to help here.  Keys in Redis can be given an expiry time, after which Redis will delete them.  We&#x27;ll use this capability to cache the results of weather API calls as Redis Strings, keeping them for an hour to achieve a balance between users seeing the absolute latest weather report for a location and the load we&#x27;re placing on the API provider&#x27;s servers.</p><p>We&#x27;ll use an extra Express middleware function to check if we&#x27;ve got the weather for a location in the Redis cache, and only go get it from the API provider if necessary.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="hands-on-exercise"></a>Hands-on Exercise<a class="hash-link" href="#hands-on-exercise" title="Direct link to heading">#</a></h2><p>In this exercise, you&#x27;ll use Postman to see how caching with Redis makes an API call faster while also saving us from incurring costs associated with using a third-party service.</p><p>You&#x27;ll be using the &quot;/location/:locationId/weather&quot; route for this exercise.  The code for this route takes a location ID, retrieves that location&#x27;s latitude and longitude from its Redis Hash, then calls the OpenWeather API with those coordinates to retrieve weather data as a JSON document.  </p><p>This document is returned to the user and cached in Redis for an hour.  Subsequent requests for the same location&#x27;s weather within the hour are handled by the middleware function that sits in front of this route&#x27;s logic.  It returns the cached value without making a request to the OpenWeather servers.</p><p>To use OpenWeather&#x27;s API, you&#x27;ll first need to <a href="https://home.openweathermap.org/users/sign_up" target="_blank" rel="noopener noreferrer">sign up for a free API key on their website</a>.</p><p>Once you have your API key, stop the API server component (Ctrl-C), and set an environment variable containing your key as follows:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token builtin class-name" style="color:rgb(255, 203, 107)">export</span><span class="token plain"> </span><span class="token assign-left variable" style="color:rgb(191, 199, 213)">WEATHER_API_KEY</span><span class="token operator" style="color:rgb(137, 221, 255)">=</span><span class="token plain">my_api_key</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Then start the server:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ </span><span class="token function" style="color:rgb(130, 170, 255)">npm</span><span class="token plain"> run dev</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Now start Postman, and click the + button to create a new request:</p><p><img alt="Postman Plus Button" src="/assets/images/postman_plus_button-e6188dceb86e12bfe874c5dae8bd413a.png"></p><p>Set the URL to <code>http://localhost:8081/api/location/99/weather</code> and make sure you have a GET request selected from the dropdown of available HTTP verbs:</p><p><img alt="Postman set URL and verb" src="/assets/images/postman_set_url-0ac44c38b5f87ff1adf4a26766aa1877.png"></p><p>Click &quot;Send&quot;, and you should see the weather report JSON for location 99 appear in the &quot;Response&quot; panel.  Make a note of the overall response time that Postman reports for this request (509 milliseconds here):</p><p><img alt="Origin Request" src="/assets/images/postman_origin_request-88b0b2c8e3771c81fc57e0f18cb8919a.png"></p><p>Take a look at the output from the API server in your terminal window, you should see that no value for location 99 was found in the cache, so the data was requested from OpenWeather and then added to the cache in Redis:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">debug: Cache miss </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> location </span><span class="token number" style="color:rgb(247, 140, 108)">99</span><span class="token plain"> weather.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Click &quot;Send&quot; in Postman again to repeat the request... This time the response will be served from Redis and will be noticeably faster. No call to the OpenWeather API was made.  Note the difference in response times when the result comes from cache (just 6 milliseconds here!):</p><p><img alt="Cached Request" src="/assets/images/postman_cached_request-9a7559f082552c2a3f37d45095d74c2e.png"></p><p>Checking the output from the API server&#x27;s terminal window shows that this request was served from cache:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">debug: Cache hit </span><span class="token keyword" style="font-style:italic">for</span><span class="token plain"> location </span><span class="token number" style="color:rgb(247, 140, 108)">99</span><span class="token plain"> weather.</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Finally, take a look at the cached data in Redis.  Use RedisInsight or redis-cli to take a look at the key <code>ncc:weather:99</code>.  The <code>TTL</code> command shows the number of seconds remaining before Redis deletes this key from the cache:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">$ redis-cli</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> GET ncc:weather:99</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> TTL ncc:weather:99</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>If you&#x27;re using RedisInsight, you can see the remaining TTL (in seconds) in the browser view:</p><p><img alt="TTL in Redis Insight" src="/assets/images/insight_ttl-e270ed2349bed7d821b82e83cb9fe1bd.png"></p><p>The key <code>ncc:weather:99</code> will be deleted an hour after it was originally written to Redis, causing the next request after that deletion for location 99&#x27;s weather to be a cache miss.  If you want to speed up this process, delete the key <code>ncc:weather:99</code> using the trash can icon in RedisInsight, or the <code>DEL</code> command in redis-cli:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-bash codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token number" style="color:rgb(247, 140, 108)">127.0</span><span class="token plain">.0.1:637</span><span class="token operator file-descriptor important" style="color:rgb(137, 221, 255)">9</span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> DEL ncc:weather:99</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Then try your request in Postman again and see what happens.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="external-resources"></a>External Resources<a class="hash-link" href="#external-resources" title="Direct link to heading">#</a></h2><p>If you&#x27;d like to learn more about caching API responses in a Node.js application with Redis, check out Justin&#x27;s excellent video:</p><div class="text--center"><iframe width="560" height="315" src="https://www.youtube.com/embed/hRecenOBYlE" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/redis-developer/redis-developer/edit/master/docs/develop/node/node-crash-course/caching/index-caching.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/develop/node/nodecrashcourse/managingsuccess"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Managing Success with Redis</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/develop/node/nodecrashcourse/sessionstorage"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Scaling an Express Application with Redis as a Session Store Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#hands-on-exercise" class="table-of-contents__link">Hands-on Exercise</a></li><li><a href="#external-resources" class="table-of-contents__link">External Resources</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><svg width="785" height="158" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="shape"><defs><path d="M786.344 392.459c-41.822 22.164-258.313 110.84-305.056 135.477-46.742 24.637-72.163 23.812-108.246 6.57-36.082-17.24-267.334-111.664-309.156-131.377-41.822-19.713-42.642-33.657-1.64-49.271C103.25 338.265 332.86 247.94 381.243 229.875c48.383-18.065 65.604-18.065 106.605-2.473 41.003 15.614 256.674 100.996 297.676 115.785 41.002 14.791 42.642 27.912.82 49.273v-.001z" id="a"></path><mask id="b" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="785" height="331" fill="#fff"><use xlink:href="#a"></use></mask></defs><use mask="url(#b)" xlink:href="#a" transform="translate(-32 -216)" stroke="#465282" stroke-width="4" fill="none" fill-rule="evenodd" stroke-dasharray="3.637"></use></svg><img src="/img/code-2.png" class="code" alt=""><div class="row"><div class="col col--3"><div class="footer__logo-ctr"><span class="footer__logo-tagline">Made with &lt;/&gt; by</span><a href="https://redis.com/" target="_blank" rel="noopener" class="footerLogoLink_3L_r"><img loading="lazy" class="footer__logo" alt="Redis Labs logo" src="/img/redis_logo_red_white_rgb.svg"></a></div></div><div class="col col--9"><div class="row footer__links"><div class="col col--4 footer__col"><h4 class="footer__title">Get Started</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/create/rediscloud">Create Database</a></li><li class="footer__item"><a class="footer__link-item" href="/develop/">Develop</a></li><li class="footer__item"><a class="footer__link-item" href="/explore/redisinsight/">Explore your data</a></li><li class="footer__item"><a href="https://redis.com/redis-best-practices/introduction/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Best Practices</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/howtos/redisearch/">Build with Redis Modules</a></li></ul></div><div class="col col--4 footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a href="https://redis.com/community/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community</a></li><li class="footer__item"><a href="https://university.redis.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Redis University</a></li><li class="footer__item"><a href="https://redis.io/commands" target="_blank" rel="noopener noreferrer" class="footer__link-item">Command Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/howtos">How-tos &amp; tutorials</a></li></ul></div></div></div></div><div class="footer__copyright">Copyright: Â© 2021 Redis. All rights reserved. Redis and the cube logo are registered trademarks of Redis Ltd.</div></div></footer></div>
<script src="/styles.67a137f0.js"></script>
<script src="/runtime~main.900e876e.js"></script>
<script src="/main.d146c69e.js"></script>
<script src="/1.82c5356d.js"></script>
<script src="/2.10c5caf9.js"></script>
<script src="/3.9525cd79.js"></script>
<script src="/1be78505.964c506b.js"></script>
<script src="/935f2afb.ec62a840.js"></script>
<script src="/17896441.9e18bbbf.js"></script>
<script src="/f2d3ddf1.729b4e13.js"></script>
</body>
</html>