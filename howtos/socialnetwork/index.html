<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/blog/rss.xml" title="Redis Developer Hub Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/blog/atom.xml" title="Redis Developer Hub Blog Atom Feed">
<script>!function(e,t,a,n,g){e[n]=e[n]||[],e[n].push({"gtm.start":(new Date).getTime(),event:"gtm.js"});var m=t.getElementsByTagName(a)[0],r=t.createElement(a);r.async=!0,r.src="https://www.googletagmanager.com/gtm.js?id=GTM-W8Z6BLQ",m.parentNode.insertBefore(r,m)}(window,document,"script","dataLayer")</script><title data-react-helmet="true">How to Build a Social Network Application using RediSearch and NodeJS | Redis Developer Hub</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="/img/share.png"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="How to Build a Social Network Application using RediSearch and NodeJS | Redis Developer Hub"><meta data-react-helmet="true" name="description" content="image"><meta data-react-helmet="true" property="og:description" content="image"><meta data-react-helmet="true" property="og:url" content="https://developer.redis.com/howtos/socialnetwork/"><link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.ico"><link data-react-helmet="true" rel="preconnect" href="https://fonts.gstatic.com"><link data-react-helmet="true" href="https://fonts.googleapis.com/css2?family=Lato:wght@400;700&amp;family=Roboto+Mono:wght@400;500;600;700&amp;display=swap" rel="stylesheet"><link data-react-helmet="true" href="/css/redis-sitesearch.css" rel="stylesheet"><link data-react-helmet="true" href="/css/redis-sitesearch-overrides.css" rel="stylesheet"><link data-react-helmet="true" rel="canonical" href="https://developer.redis.com/howtos/socialnetwork/"><link rel="stylesheet" href="/styles.3f36c093.css">
<link rel="stylesheet" href="/main.57e3ec54.css">
<link rel="preload" href="/styles.8d98465d.js" as="script">
<link rel="preload" href="/runtime~main.b2047c58.js" as="script">
<link rel="preload" href="/main.cb3f99d8.js" as="script">
<link rel="preload" href="/1.eb65e30c.js" as="script">
<link rel="preload" href="/2.385151cf.js" as="script">
<link rel="preload" href="/3.6fea1344.js" as="script">
<link rel="preload" href="/1be78505.3b0f0ec2.js" as="script">
<link rel="preload" href="/935f2afb.383a2faf.js" as="script">
<link rel="preload" href="/17896441.37266eed.js" as="script">
<link rel="preload" href="/2bc54e2b.1959e0a4.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-W8Z6BLQ" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top navbar--dark"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg width="24" height="18" xmlns="http://www.w3.org/2000/svg"><g stroke="#FFFFFF" stroke-width="1.65" fill="none" fill-rule="evenodd" stroke-dasharray="4.4" stroke-linecap="round" stroke-linejoin="round"><path d="M1 16.95h24.2M1 9.25h24.2M1 1.55h24.2"></path></g></svg></div><a class="navbar__brand" href="/"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar__items navbar__items--right"><div id="redis-sitesearch" class="redis-sitesearch redis-sitesearch-inline"><input class="redis-sitesearch-input"><div class="redis-sitesearch-result-list-wrapper"><ul class="redis-sitesearch-result-list"></ul><div class="redisearch-logo"></div></div></div><a class="navbar__item navbar__link" href="/create/rediscloud">Get started</a><a href="https://launchpad.redis.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Redis Launchpad</a><a href="https://redis.com/try-free/" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Try Free</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_16CL"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/img/logo-1.png" alt="Redis Developer Hub logo" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/create/rediscloud">Get started</a></li><li class="menu__list-item"><a href="https://launchpad.redis.com" target="_blank" rel="noopener noreferrer" class="menu__link">Redis Launchpad</a></li><li class="menu__list-item"><a href="https://redis.com/try-free/" target="_blank" rel="noopener noreferrer" class="menu__link">Try Free</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_25T_"><div class="menu menu--responsive thin-scrollbar menu_1e9D"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1hKf" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/">Home</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Create</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/rediscloud">Redis Enterprise Cloud</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on Heroku</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/portal">Redis on Heroku</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/herokujava">How to deploy a Java based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/herokunodejs">How to deploy a NodeJS based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/herokupython">How to deploy a Python based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/heroku/ratelimiting-go">How to deploy a Redis Rate Limiting application on Heroku</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on Azure Cache</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/portal">Redis on Azure Cache</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/terraform-simple">Redis Enterprise with Terraform</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/azure/terraform-private-endpoint">Azure Cache for Redis Enterprise using Terraform with Private Link</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/gcp">Redis on Google Cloud</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/aws">Redis on AWS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/docker/">Redis on Docker</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis on Kubernetes</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/kubernetes/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/kubernetes/kubernetes-gke">Redis on Kubernetes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/kubernetes/kubernetes-operator">Kubernetes Operator: What It Is and Why You Should Really Care About It</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/homebrew/">Redis on Mac</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/windows">Redis on Windows</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/create/from-source/">Redis from Source</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Develop</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Java</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Spring</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis OM Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/redis-om/redis-om-spring">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/redis-om/redis-om-spring-json">Working with JSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/redis-om/redis-om-spring-hash">Working with Hashes</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis and Spring Course</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_1">Up and Running</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_2">Spring Data Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_3">Mapping &amp; Repositories</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_4">User Roles &amp; Secondary Indexes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_5">Books, Categories &amp; The Catalog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_6">Domain Models w/ RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_7">Search w/ RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_8">Recommendations w/ RedisGraph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/redis-and-spring-course/lesson_9">Caching w/ Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Rate Limiting</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Fixed Window</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting/fixed-window">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting/fixed-window/reactive">Reactive Implementation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting/fixed-window/reactive-lua">Atomicity with Lua</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/java/spring/rate-limiting/fixed-window/reactive-gears">Atomicity with Gears</a></li></ul></li></ul></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/C/">C</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Node.js</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/gettingstarted">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Node.js Crash Course</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/node-crash-course">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/welcome">Welcome</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/whatisredis">What is Redis?</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/redisandnodejs">Redis and Node.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/introducingredisinsight">Introducing RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/sampleapplicationoverview">Sample Application Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/runningtheapplication">Running the Application</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/domainobjectswithhashes">Domain Objects with Hashes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/introductiontomodules">Introduction to Modules</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/redisjson">RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/redisearch">RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/checkinswithstreams">Checkins with Streams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/managingsuccess">Managing Success</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/caching">Caching</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/sessionstorage">Session Storage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/advancedstreams">Advanced Streams</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/redisbloom">RedisBloom</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/nodecrashcourse/coursewrapup">Wrap Up</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/node/redis-om">Redis OM for Node.js</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Python</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/python/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/python/fastapi">Redis with FastAPI</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">.NET</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/">Getting Started</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">ASP.NET Core</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/aspnetcore/rate-limiting/fixed-window">Fixed Window Rate Limiting app using ASP.NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/aspnetcore/rate-limiting/sliding-window">Sliding Window Rate Limiting app  using ASP.NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/aspnetcore/rate-limiting/middleware">Rate Limiting Middleware</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Redis OM Dotnet</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/connecting-to-redis">Connecting to Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/add-and-retrieve-objects">Add and Retrieve Objects</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/searching/creating-an-index">Creating an Index</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Querying</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/simple-text-queries">Simple Text Queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/searching/numeric-queries">Numeric Queries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/searching/geo-filters">Geo Filters</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Aggregations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/aggregations">Aggregations Intro</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/aggregations/apply-functions">Apply Functions</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/dotnet/redis-om-dotnet/aggregations/groups/groups">Grouping and Reductions</a></li></ul></li></ul></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/golang/">Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/ruby/">Ruby</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/develop/php/">Php</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Explore</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore">Overview</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisInsight v2.x</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2/getting-started">Getting Started with RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsightv2/browser">Visualize Redis Database keys using the RedisInsight Browser Tool</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">RedisInsight v1.x</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/getting-started">Getting Started with RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/browser">Visualize Redis database keys using RedisInsight Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/slowlog">Debug Redis using RedisInsight Slowlog Debugging Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/memoryanalyzer">Optimize &amp; Analyze Redis using RedisInsight Memory Analyzer Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/cluster">Manage Your Redis Cluster using RedisInsight Cluster Management Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/streams">Use Redis Streams Consumer Groups with RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/profiler">RedisInsight Profiler Tool - Analyze Your Redis Commands Using Redis Monitor Command</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisgraph">Query, Visualize and Manipulate Graphs using RedisGraph Browser Visualization Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisgears">Write Your Serverless Redis function using RedisGears Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redistimeseries">Manage Redis time-series data using RedisTimeSeries Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/redisearch">Perform Database Search and Analytics using RediSearch Browser Tool</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/autodiscover">Utilize Elasticache Auto Discovery For Redis with RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisinsight/usinghelm">Installing RedisInsight using Helm</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisdatasource">Redis Data Source for Grafana</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redisexplorer">Grafana Dashboards for Redis Enterprise Cluster</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/datadog">Redis Enterprise Observability with Datadog</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/redismod">RedisMod</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/explore/riot">RIOT</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">HowTos &amp; Tutorials</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/redisearch">RediSearch Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">RedisJSON Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/getting-started">Getting Started with RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-python">RedisJSON and Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-nodejs">RedisJSON and Node.js</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-ruby">RedisJSON and Ruby</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-go">RedisJSON and Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-java">RedisJSON and Java</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/using-redisinsight">RedisJSON using RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/storing-complex-json-document">Storing and retrieving Nested JSON document</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/jsonind-document">Indexing JSON document using RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/redisjson-cheatsheet">RedisJSON CheatSheet</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/shoppingcart">How to build a Shopping cart app using NodeJS and RedisJSON</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisjson/storing-json-using-nodejs">Storing and retrieving JSON documents using Node.js</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">RedisTimeSeries Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/getting-started">Getting Started with RedisTimeSeries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/using-python">RedisTimeSeries and Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/using-dotnet">Using RedisTimeSeries with .NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/using-go">RedisTimeSeries and Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redistimeseries/using-prometheus">Using RedisTimeSeries with Prometheus and Grafana</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">RedisGraph Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/getting-started">Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/explore-python-code">Explore Python Codebase using RedisGraph</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-redisinsight">RedisGraph using RedisInsight</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-dotnet">RedisGraph and .NET</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-python">RedisGraph and Python</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-ruby">RedisGraph and Ruby</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-javascript">RedisGraph and JavaScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-go">RedisGraph and Go</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/using-rust">RedisGraph and Rust</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/redisgraphmovies">Building Movies database app using RedisGraph &amp; NodeJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisgraph/csvtograph">Building RedisGraph databases from CSV inputs</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">Redis Bloom Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisbloom">RedisBloom Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisbloom/with-dotnet/redisbloom-withdotnet">Using RedisBloom with .NET</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/redisgears">RedisGears Tutorial</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">RedisAI Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisai/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisai/getting-started">RedisAI Tutorial</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/redisai/market-basket-analysis">Market-Basket Analysis using RedisAI and RedisGears</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/leaderboard">How to build a Real-Time Leaderboard app Using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/ratelimiting">How to build a Rate Limiter using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/caching">How to cache REST API responses Using Redis &amp; NodeJS</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="0">How to list &amp; search Movies database using RediSearch</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/getting-started">1. Getting Started</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/install">2. Install Redisearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/create">3. Create Index</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/query">4. Query Data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/manage">5. Manage Index</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/import">6. Import datasets</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/querymovies">7. Query Movies</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/aggregation">8. Aggregation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/advancedoption">9. Advanced Option</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/howtos/moviesdatabase/sampleapp">10. Sample Application</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/chatapp">How to build a Chat application using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/frauddetection">How to build a Fraud Detection System using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/redisgraphmovies">Building Movies database app using RedisGraph and NodeJS</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/nlp">Building a Pipeline for Natural Language Processing using RedisGears</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/hackernews">How to build a HackerNews Clone using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/antipatterns/">Redis Anti-Patterns Every Developer Should Avoid</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/howtos/socialnetwork/">Building a Social Network Application using RediSearch</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/security/">How to Use SSL/TLS With Redis Enterprise</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/analytics">Building an Analytics dashboard app using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/popupstore">Building a Popup Store application using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/herokunodejs">How to build a NodeJS based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/herokupython">How to build a Python based application on Heroku using Redis</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/howtos/herokujava">How to build a Java based application on Heroku using Redis</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Get Involved</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/">Overview</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/devcember/">DEVcember</a></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!" tabindex="-1">Hacktoberfest 2021</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hacktoberfest/">Start Here</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hacktoberfest/stories/lara-aasem">Lara&#x27;s Hacktoberfest at Redis Story</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/hacktoberfest/stories/vincent-aceto">Vincent&#x27;s Hacktoberfest at Redis Story</a></li></ul></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/discord/">Discord</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/community/redis-live/">Redis Live</a></li></ul></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_2AGf"><div class="docItemContainer_1tAC"><article><header><h1 class="docTitle_cWlf">How to Build a Social Network Application using RediSearch and NodeJS</h1></header><div class="docAuthors"><hr><div class="authorByline_1uE2"><img class="authorProfileImage_3uFP" src="/img/profile_pic_julian_mateu.jpg" alt="Profile picture for Julian Mateu"> <div><div class="authorLabel_3qT7">Author:</div><div><a href="https://www.linkedin.com/in/julian-mateu" target="_blank">Julian Mateu</a>, Sr. Backend Software Engineer at Globality, Inc.</div></div></div><div class="authorByline_1uE2"><img class="authorProfileImage_3uFP" src="/img/profile_pic_manuel_aguirre.jpg" alt="Profile picture for Manuel Aguirre"> <div><div class="authorLabel_3qT7">Author:</div><div><a href="https://github.com/manuelaguirre" target="_blank">Manuel Aguirre</a>, Backend Engineer at Baseline Spain</div></div></div><hr></div><div class="markdown"><p><img alt="image" src="/assets/images/socialnetwork-826a3451d7cf05bf179d96fa74c0e72c.png"></p><p>In this blog post we’ll build a social network application using RediSearch and NodeJS. This is the idea that we used for our app <a href="https://www.youtube.com/watch?v=18NPKZy28cQ" target="_blank" rel="noopener noreferrer">Skillmarket</a>.</p><p>The goal of the application is to match users with complementary skills. It will allow users to register and provide some information about themselves, like location, areas of expertise and interests. Using RediSearch it will match two users who are geographically close, and have complementary areas of expertise and interests, e.g., one of them knows French and want to learn Guitar and the other knows Guitar and want to learn French.</p><p>The full source code of our application can be found in GitHub (note that we used some features like <a href="https://oss.redis.com/redisearch/Commands/#ftadd" target="_blank" rel="noopener noreferrer">FT.ADD</a> which now are deprecated):</p><ul><li><a href="https://github.com/julianmateu/skillmarket-backend" target="_blank" rel="noopener noreferrer">Skillmarket Backend</a></li><li><a href="https://github.com/julianmateu/skillmarket-front" target="_blank" rel="noopener noreferrer">Skillmarket Frontend</a></li></ul><p>We will be using a more condensed version of the backend which can be found in the <a href="https://github.com/julianmateu/skillmarket-blogpost" target="_blank" rel="noopener noreferrer">Skillmarket Blogpost</a> GitHub repo.</p><p>Refer to the <a href="https://github.com/RediSearch/redisearch-getting-started" target="_blank" rel="noopener noreferrer">official tutorial</a> for more information about RediSearch.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="getting-familiar-with-redisearch"></a>Getting Familiar with RediSearch<a class="hash-link" href="#getting-familiar-with-redisearch" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="launching-redisearch-in-a-docker-container"></a>Launching RediSearch in a Docker container<a class="hash-link" href="#launching-redisearch-in-a-docker-container" title="Direct link to heading">#</a></h3><p>Let’s start by launching Redis from the RediSearch image using Docker:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker run -d --name redis redislabs/redisearch:latest</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Here we use the <code>docker run</code> command to start the container and pull the image if it is not present. The <code>-d</code> flag tells docker to launch the container in the background (detached mode). We provide a name with <code>--name redis</code> which will allow us to refer to this container with a friendly name instead of the hash or the random name docker will assign to it. </p><p>Finally, <code>redislabs/readisearch:latest</code> tells docker to use the <code>latest</code> version of the <a href="https://hub.docker.com/r/redislabs/redisearch" target="_blank" rel="noopener noreferrer">redislabs/readisearch image</a></p><p>Once the image starts, we can use <code>docker exec</code> to launch a terminal inside the container, using the <code>-it</code> flag (interactive tty) and specifying the <code>redis</code> name provided before when creating the image, and the <code>bash</code> command:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker exec -it redis bash</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Once inside the container, let’s launch a <code>redis-cli</code> instance to familiarize ourselves with the CLI:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">redis-cli</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>You will notice the prompt now indicates we’re connected to <code>127.0.0.1:6379</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="creating-users"></a>Creating Users<a class="hash-link" href="#creating-users" title="Direct link to heading">#</a></h3><p>We’ll use a Hash as the data structure to store information about our users. This will be a proof of concept, so our application will only use Redis as the data store. For a real life scenario, it would probably be better to have a primary data store which is the authoritative source of user data, and use Redis as the search index which can be used to speed up searches.</p><p>In a nutshell, you can think of a hash as a key/value store where the key can be any string we want, and the values are a document with several fields. It’s common practise to use the hash to store many different types of objects, so they can be prefixed with their type, so a key would take the form of &quot;object_type:id&quot;.</p><p>An index will then be used on this hash data structure, to efficiently search for values of given fields. The following diagram taken from the RediSearch docs exeplifies this with a database for movies: </p><p><img alt="alt_text" src="/assets/images/searchindex-7e01db6630f70050d4d27a6d7b8a6c4d.png" title="image_tooltip"></p><p>Use the <code>help @hash</code> command (or refer to the <a href="https://redis.io/commands#hash" target="_blank" rel="noopener noreferrer">documentation</a>) to get a list of commands that can be used to manipulate hashes. To get help for a single command, like <code>HSET</code> let’s type <code>help HSET</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">127.0.0.1:6379&gt; help hset</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  HSET key field value [field value ...]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  summary: Set the string value of a hash field</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  since: 2.0.0</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  group: hash</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>As we see, we can provide a key and a list of <code>field value</code> pairs.</p><p>We’ll create a user in the hash table by using <code>user:id</code> as the key, and we’ll provide the fields <code>expertises</code>, <code>interests</code> and <code>location</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">HSET users:1 name &quot;Alice&quot; expertises &quot;piano, dancing&quot; interests &quot;spanish, bowling&quot; location &quot;2.2948552,48.8736537&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HSET users:2 name &quot;Bob&quot; expertises &quot;french, spanish&quot; interests &quot;piano&quot; location &quot;2.2945412,48.8583206&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HSET users:3 name &quot;Charles&quot; expertises &quot;spanish, bowling&quot; interests &quot;piano, dancing&quot; location &quot;-0.124772,51.5007169&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="query-to-match-users"></a>Query to match users<a class="hash-link" href="#query-to-match-users" title="Direct link to heading">#</a></h3><p>Here we can see the power of the RediSearch index, which allows us to query by <a href="https://oss.redis.com/redisearch/Tags/" target="_blank" rel="noopener noreferrer">tags</a> (we provide a list of values, such as interests, and it will return any user whose interests match at least one value in the list), and <a href="https://oss.redis.com/redisearch/Query_Syntax/#geo_filters_in_query" target="_blank" rel="noopener noreferrer">Geo</a> (we can ask for users whose location is at a given radius in km from a point).</p><p>To be able to do this, we have to instruct RediSearch to create an index:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">FT.CREATE idx:users ON hash PREFIX 1 &quot;users:&quot; SCHEMA interests TAG expertises TAG location GEO</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We use the <a href="https://oss.redis.com/redisearch/Commands/#ftcreate" target="_blank" rel="noopener noreferrer">FT.CREATE</a> command to create a full text search index named <code>idx:users</code>. We specify <code>ON hash</code> to indicate that we’re indexing the hash table, and provide <code>PREFIX 1 &quot;users:&quot;</code> to indicate that we should index any document whose key starts with the prefix “users:”. Finally we indicate the <code>SCHEMA</code> of the index by providing a list of fields to index, and their type.</p><p>Finally, we can query the index using the <a href="https://oss.redis.com/redisearch/Commands/#ftsearch" target="_blank" rel="noopener noreferrer">FT.SEARCH</a> command (see the <a href="https://oss.redis.com/redisearch/Query_Syntax/#search_query_syntax" target="_blank" rel="noopener noreferrer">query syntax reference</a>):</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">127.0.0.1:6379&gt; FT.SEARCH idx:users &quot;@interests:{dancing|piano} @expertises:{spanish|bowling} @location:[2.2948552 48.8736537 5 km]&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">1) (integer) 1</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2) &quot;users:2&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">3) 1) &quot;name&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   2) &quot;Bob&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   3) &quot;expertises&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   4) &quot;french, spanish&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   5) &quot;interests&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   6) &quot;piano&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   7) &quot;location&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   8) &quot;2.2945412,48.8583206&quot;</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>In this case we’re looking for matches for Alice, so we use her expertises in the <code>interests</code> field of the query, and her interests in the <code>expertises</code> field. We also search for users in a 5km radius from her location, and we get Bob as a match.</p><p>If we expand the search radius to 500km we’ll also see that Charles is returned:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">127.0.0.1:6379&gt; FT.SEARCH idx:users &quot;@interests:{dancing|piano} @expertises:{spanish|bowling} @location:[2.2948552 48.8736537 500 km]&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">1) (integer) 2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">2) &quot;users:3&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">3) 1) &quot;name&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   2) &quot;Charles&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   3) &quot;expertises&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   4) &quot;spanish, bowling&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   5) &quot;interests&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   6) &quot;piano, dancing&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   7) &quot;location&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   8) &quot;-0.124772,51.5007169&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">4) &quot;users:2&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">5) 1) &quot;name&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   2) &quot;Bob&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   3) &quot;expertises&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   4) &quot;french, spanish&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   5) &quot;interests&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   6) &quot;piano&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   7) &quot;location&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   8) &quot;2.2945412,48.8583206&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cleaning-up"></a>Cleaning Up<a class="hash-link" href="#cleaning-up" title="Direct link to heading">#</a></h3><p>We can now remove the docker instance and move on to building the web application, running the following command from outside the instance:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker rm -f redis</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="building-a-minimal-backend-in-typescript"></a>Building a minimal backend in Typescript<a class="hash-link" href="#building-a-minimal-backend-in-typescript" title="Direct link to heading">#</a></h3><p>After understanding how the index works, let’s build a minimal backend API in NodeJS that will allow us to create a user, and query for matching users.</p><p>Please note that this is just an example, and we’re not providing proper validation or error handling, nor other features required for the backend (e.g. authentication).</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="redis-client"></a>Redis client<a class="hash-link" href="#redis-client" title="Direct link to heading">#</a></h3><p>We’ll use the <a href="https://www.npmjs.com/package/redis" target="_blank" rel="noopener noreferrer">node-redis</a> package to create a client:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">const {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    REDIS_PORT = 6379,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    REDIS_HOST = &#x27;localhost&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">} = process.env;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">const client: RediSearchClient = createClient({</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    port: Number(REDIS_PORT),</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    host: REDIS_HOST,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Given that the raw client does not include the functions from the rediSearch module, we have to add them by defining a new type and adding the commands (this is what the <a href="https://www.npmjs.com/package/redis-redisearch" target="_blank" rel="noopener noreferrer">redis-redisearch</a> module does, and there’s also another module named <a href="https://www.npmjs.com/package/redisearchclient" target="_blank" rel="noopener noreferrer">redisearchclient</a> which also provides more functions instead of providing arguments as strings).</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">type RediSearchClient = RedisClient &amp; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ft_create?(args: any): any;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ft_search?(args: any): any;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    hgetallAsync?(key: string): Promise&lt;any&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    hsetAsync?(key: string, fields: string[]): Promise&lt;any&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ft_createAsync?(index: string, args: string[]): Promise&lt;any&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    ft_searchAsync?(index: string, query: string): Promise&lt;any&gt;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">addCommand(&#x27;ft.create&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">addCommand(&#x27;ft.search&#x27;);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>All the functions in the library use callbacks, but we can use <code>promisify</code> to enable the <code>async/await</code> syntax:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">client.hgetallAsync = promisify(client.hgetall).bind(client);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">client.hsetAsync = promisify(client.hset).bind(client);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">client.ft_createAsync = promisify(client.ft_create).bind(client);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">client.ft_searchAsync = promisify(client.ft_search).bind(client);</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Finally, let’s define a function to create the user index, as we did before in the CLI example:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">async function createUserIndex() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    client.ft_createAsync(</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &#x27;idx:users&#x27;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        [&#x27;ON&#x27;, &#x27;hash&#x27;, &#x27;PREFIX&#x27;, &#x27;1&#x27;, &#x27;users:&#x27;, &#x27;SCHEMA&#x27;, &#x27;interests&#x27;, &#x27;TAG&#x27;, &#x27;expertises&#x27;, &#x27;TAG&#x27;, &#x27;location&#x27;, &#x27;GEO&#x27;]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    );</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="user-controller"></a>User controller<a class="hash-link" href="#user-controller" title="Direct link to heading">#</a></h3><p>Let’s define the functions that the controller will use to expose a simple API on top of Redis. We’ll define 3 functions: - <code>findUserById(userId)</code> - <code>createUser(user)</code> - <code>findMatchesForUser(user)</code></p><p>But first let’s define the model we’ll use for the users:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">interface Location {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    latitude: number;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    longitude: number;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">interface User {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    id?: string;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    name: string;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    interests: string[];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    expertises: string[];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    location: Location</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">};</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Let’s start with the function to create a user from the model object:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">async function createUser(user: User): Promise&lt;string&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    const id = uuid();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    redisearchClient.hsetAsync(`users:${id}`, _userToSetRequestString(user));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return id;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _userToSetRequestString(user: User): string[] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    const { id, location, interests, expertises, ...fields } = user;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    let result = Object.entries(fields).flat();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    result.push(&#x27;interests&#x27;, interests.join(&#x27;, &#x27;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    result.push(&#x27;expertises&#x27;, expertises.join(&#x27;, &#x27;));</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    result.push(&#x27;location&#x27;, `${location.longitude},${location.latitude}`);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return result;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>We will create a UUID for the user, and then transform the TAG and GEO fields to the redis format. Here’s an example of how these two formats look like:</p><p><img alt="my image" src="/assets/images/image_socialnetwork-07f7d7d7f2a5536e6493575ac71d8f88.png"></p><p>Let’s now look at the logic to retrieve an existing user from the Hash table using <code>HGETALL</code>:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">async function findUserById(userId: string): Promise&lt;User&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    const response = await redisearchClient.hgetallAsync(`users:${userId}`);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!response) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        throw new Error(&#x27;User Not Found&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return _userFromFlatEntriesArray(userId, Object.entries(response).flat());</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _userFromFlatEntriesArray(id: string, flatEntriesArray: any[]): User {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   let user: any = {};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // The flat entries array contains all keys and values as elements in an array, e.g.:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    // [key1, value1, key2, value2]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    for (let j = 0; j &lt; flatEntriesArray.length; j += 2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">       let key: string = flatEntriesArray[ j ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        let value: string = flatEntriesArray[ j + 1 ];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        user[ key ] = value;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    const location: string[] = user.location.split(&#x27;,&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    user.location = { longitude: Number(location[ 0 ]), latitude: Number(location[ 1 ]) };</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    user.expertises = user.expertises.split(&#x27;, &#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    user.interests = user.interests.split(&#x27;, &#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    return {id, ...user};</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Here we have the inverse logic, where we want to split the TAG and GEO fields into a model object. There’s also the fact that <code>HGETALL</code> returns the field names and values in an array, and we need to build the model object from that.</p><p>Let’s finally take a look at the logic to find matches for a given user:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">async function findMatchesForUser(user: User, radiusKm: number): Promise&lt;User[]&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   const allMatches: User[] = await _findMatches(user.interests, user.expertises, user.location, radiusKm);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return allMatches.filter(u =&gt; u.id !== user.id);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">async function _findMatches(expertises: string[], interests: string[], location: Location, radiusKm: number): Promise&lt;User[]&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   let query = `@interests:{${interests.join(&#x27;|&#x27;)}}`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      query += ` @expertises:{${expertises.join(&#x27;|&#x27;)}}`</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      query += ` @location:[${location.longitude} ${location.latitude} ${radiusKm} km]`;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      const response = await redisearchClient.ft_searchAsync(&#x27;idx:users&#x27;, query);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return _usersFromSearchResponseArray(response);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">function _usersFromSearchResponseArray(response: any[]): User[] {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   let users = [];</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // The search response is an array where the first element indicates the number of results, and then</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // the array contains all matches in order, one element is they key and the next is the object, e.g.:</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      // [2, key1, object1, key2, object2]</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      for (let i = 1; i &lt;= 2 * response[ 0 ]; i += 2) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         const user: User = _userFromFlatEntriesArray(response[ i ].replace(&#x27;users:&#x27;, &#x27;&#x27;), response[ i + 1 ]);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">         users.push(user);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">      return users;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Here we swap interests and expertises to find the complementary skill set, and we build the query that we used previously in the CLI example. we finally call the <code>FT.SEARCH</code> function, and we build the model object from the response, which comes as an array. Results are filtered to exclude the current user from the matches list.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="web-api"></a>Web API<a class="hash-link" href="#web-api" title="Direct link to heading">#</a></h3><p>Finally, we can build a trivial web API using express, exposing a <code>POST /users</code> endpoint to create a user, a <code>GET /users/:userId</code> endpoint to retrieve a user, and a <code>GET /users/:userId/matches</code> endpoint to find matches for the given user (the desired <code>radiusKm</code> can be optionally specified as a query parameter)</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">app.post(&#x27;/users&#x27;, async (req, res) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    const user: User = req.body;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    if (!user || !user.name || !user.expertises || !user.interests || user.location.latitude === undefined || user.location.longitude === undefined) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        res.status(400).send(&#x27;Missing required fields&#x27;);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } else {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        const userId = await userController.createUser(user);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        res.status(200).send(userId);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">app.get(&quot;/users/:userId&quot;, async (req, res) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    try {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        const user: User = await userController.findUserById(req.params.userId);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        res.status(200).send(user);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } catch (e) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        res.status(404).send();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">app.get(&quot;/users/:userId/matches&quot;, async (req, res) =&gt; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    try {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        const radiusKm: number = Number(req.query.radiusKm) || 500;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        const user: User = await userController.findUserById(req.params.userId);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        const matches: User[] = await userController.findMatchesForUser(user, radiusKm);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        res.status(200).send(matches);</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    } catch (e) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        console.log(e)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        res.status(404).send();</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">});</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="full-code-example"></a>Full code example<a class="hash-link" href="#full-code-example" title="Direct link to heading">#</a></h3><p>The code used in this blogpost can be found in the <a href="https://github.com/julianmateu/skillmarket-blogpost" target="_blank" rel="noopener noreferrer">GitHub repo</a>. The backend together with redis can be launched using docker compose:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain"> docker compose up -d --build</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>The backend API will be exposed on port <code>8080</code>. We can see the logs with <code>docker compose logs</code>, and use a client to query it. Here’s an example using httpie:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">http :8080/users \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   name=&quot;Alice&quot; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   expertises:=&#x27;[&quot;piano&quot;, &quot;dancing&quot;]&#x27; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   interests:=&#x27;[&quot;spanish&quot;, &quot;bowling&quot;]&#x27; \</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">   location:=&#x27;{&quot;longitude&quot;: 2.2948552, &quot;latitude&quot;: 48.8736537}&#x27;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">----------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HTTP/1.1 200 OK</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Connection: keep-alive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Length: 36</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: text/html; charset=utf-8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Date: Mon, 01 Nov 2021 05:24:52 GMT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ETag: W/&quot;24-dMinMMphAGzfWiCs49RBYnyK+r8&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Keep-Alive: timeout=5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">X-Powered-By: Express</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">03aef405-ef37-4254-ab3c-a5ddfbc4f04e</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">http &quot;:8080/users/03aef405-ef37-4254-ab3c-a5ddfbc4f04e/matches?radiusKm=15&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">HTTP/1.1 200 OK</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Connection: keep-alive</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Length: 174</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Content-Type: application/json; charset=utf-8</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Date: Mon, 01 Nov 2021 05:26:29 GMT</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">ETag: W/&quot;ae-3k2/swmuFaJd7BNHrkgvS/S+h2g&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">Keep-Alive: timeout=5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">X-Powered-By: Express</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">[</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;expertises&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;french&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot; spanish&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;id&quot;: &quot;58e81f09-d9fa-4557-9b8f-9f48a9cec328&quot;,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;interests&quot;: [</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;piano&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        ],</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;location&quot;: {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;latitude&quot;: 48.8583206,</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">            &quot;longitude&quot;: 2.2945412</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        },</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        &quot;name&quot;: &quot;Bob&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">]</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p>Finally cleanup the environment:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-undefined codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">docker compose down --volumes --remove-orphans</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="references"></a>References<a class="hash-link" href="#references" title="Direct link to heading">#</a></h3><ul><li><a href="https://github.com/julianmateu/skillmarket-backend" target="_blank" rel="noopener noreferrer">Skillmarket Backend</a></li><li><a href="https://github.com/julianmateu/skillmarket-front" target="_blank" rel="noopener noreferrer">Skillmarket Frontend</a></li><li><a href="https://github.com/RediSearch/redisearch-getting-started" target="_blank" rel="noopener noreferrer">RediSearch Official Tutorial</a></li></ul><h2></h2><div><a href="https://launchpad.redis.com" target="_blank" rel="noopener" class="link"> <img src="/img/launchpad.png" class="thumb" loading="lazy" alt="Redis Launchpad"></a></div></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/socialnetwork/index-socialnetwork.mdx" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/howtos/antipatterns/"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« Redis Anti-Patterns Every Developer Should Avoid</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/howtos/security/"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">How to Use SSL/TLS With Redis Enterprise »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#getting-familiar-with-redisearch" class="table-of-contents__link">Getting Familiar with RediSearch</a><ul><li><a href="#launching-redisearch-in-a-docker-container" class="table-of-contents__link">Launching RediSearch in a Docker container</a></li><li><a href="#creating-users" class="table-of-contents__link">Creating Users</a></li><li><a href="#query-to-match-users" class="table-of-contents__link">Query to match users</a></li><li><a href="#cleaning-up" class="table-of-contents__link">Cleaning Up</a></li><li><a href="#building-a-minimal-backend-in-typescript" class="table-of-contents__link">Building a minimal backend in Typescript</a></li><li><a href="#redis-client" class="table-of-contents__link">Redis client</a></li><li><a href="#user-controller" class="table-of-contents__link">User controller</a></li><li><a href="#web-api" class="table-of-contents__link">Web API</a></li><li><a href="#full-code-example" class="table-of-contents__link">Full code example</a></li><li><a href="#references" class="table-of-contents__link">References</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><svg width="785" height="158" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="shape"><defs><path d="M786.344 392.459c-41.822 22.164-258.313 110.84-305.056 135.477-46.742 24.637-72.163 23.812-108.246 6.57-36.082-17.24-267.334-111.664-309.156-131.377-41.822-19.713-42.642-33.657-1.64-49.271C103.25 338.265 332.86 247.94 381.243 229.875c48.383-18.065 65.604-18.065 106.605-2.473 41.003 15.614 256.674 100.996 297.676 115.785 41.002 14.791 42.642 27.912.82 49.273v-.001z" id="a"></path><mask id="b" maskContentUnits="userSpaceOnUse" maskUnits="objectBoundingBox" x="0" y="0" width="785" height="331" fill="#fff"><use xlink:href="#a"></use></mask></defs><use mask="url(#b)" xlink:href="#a" transform="translate(-32 -216)" stroke="#465282" stroke-width="4" fill="none" fill-rule="evenodd" stroke-dasharray="3.637"></use></svg><img src="/img/code-2.png" class="code" alt=""><div class="row"><div class="col col--3"><div class="footer__logo-ctr"><span class="footer__logo-tagline">Made with &lt;/&gt; by</span><a href="https://redis.com/" target="_blank" rel="noopener" class="footerLogoLink_3L_r"><img loading="lazy" class="footer__logo" alt="Redis logo" src="/img/redis_logo_red_white_rgb.svg"></a></div></div><div class="col col--9"><div class="row footer__links"><div class="col col--4 footer__col"><h4 class="footer__title">Get Started</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/create/rediscloud">Create Database</a></li><li class="footer__item"><a class="footer__link-item" href="/develop/">Develop</a></li><li class="footer__item"><a class="footer__link-item" href="/explore/redisinsight/">Explore your data</a></li><li class="footer__item"><a href="https://redis.com/redis-best-practices/introduction/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Best Practices</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="/howtos/redisearch/">Build with Redis Modules</a></li></ul></div><div class="col col--4 footer__col"><h4 class="footer__title">Resources</h4><ul class="footer__items"><li class="footer__item"><a href="https://redis.com/community/" target="_blank" rel="noopener noreferrer" class="footer__link-item">Community</a></li><li class="footer__item"><a href="https://university.redis.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Redis University</a></li><li class="footer__item"><a href="https://redis.io/commands" target="_blank" rel="noopener noreferrer" class="footer__link-item">Command Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/howtos">How-tos &amp; tutorials</a></li></ul></div></div></div></div><div class="footer__copyright">Copyright: © 2021 Redis. All rights reserved. Redis and the cube logo are registered trademarks of Redis Ltd.</div></div></footer></div>
<script src="/styles.8d98465d.js"></script>
<script src="/runtime~main.b2047c58.js"></script>
<script src="/main.cb3f99d8.js"></script>
<script src="/1.eb65e30c.js"></script>
<script src="/2.385151cf.js"></script>
<script src="/3.6fea1344.js"></script>
<script src="/1be78505.3b0f0ec2.js"></script>
<script src="/935f2afb.383a2faf.js"></script>
<script src="/17896441.37266eed.js"></script>
<script src="/2bc54e2b.1959e0a4.js"></script>
</body>
</html>