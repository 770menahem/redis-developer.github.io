(window.webpackJsonp=window.webpackJsonp||[]).push([[52],{120:function(e,t,i){"use strict";i.r(t),i.d(t,"frontMatter",(function(){return a})),i.d(t,"metadata",(function(){return o})),i.d(t,"toc",(function(){return d})),i.d(t,"default",(function(){return c}));var n=i(3),r=i(7),s=(i(0),i(296)),a={id:"index-usingpython",title:"How to collect and process time-series data using Redis and Python",sidebar_label:"RedisTimeSeries and Python",slug:"/howtos/redistimeseries/using-python",authors:["ajeet"]},o={unversionedId:"howtos/redistimeseries/using-python/index-usingpython",id:"howtos/redistimeseries/using-python/index-usingpython",isDocsHomePage:!1,title:"How to collect and process time-series data using Redis and Python",description:"My Image",source:"@site/docs/howtos/redistimeseries/using-python/index-usingpython.mdx",slug:"/howtos/redistimeseries/using-python",permalink:"/howtos/redistimeseries/using-python",editUrl:"https://github.com/redis-developer/redis-developer/edit/master/docs/howtos/redistimeseries/using-python/index-usingpython.mdx",version:"current",sidebar_label:"RedisTimeSeries and Python",sidebar:"docs",previous:{title:"Getting Started with RedisTimeSeries",permalink:"/howtos/redistimeseries/getting-started"},next:{title:"Processing Time Series data with Redis and .NET",permalink:"/howtos/redistimeseries/using-dotnet"}},d=[{value:"RedisTimeSeries Python Client",id:"redistimeseries-python-client",children:[{value:"Step 1. Create a free Redis Enterprise cloud account",id:"step-1-create-a-free-redis-enterprise-cloud-account",children:[]},{value:"Step 2. Create Your subscription",id:"step-2-create-your-subscription",children:[]},{value:"Step 3. Select the right Subscription Plan",id:"step-3-select-the-right-subscription-plan",children:[]},{value:"Step 4. Select cloud vendor",id:"step-4-select-cloud-vendor",children:[]},{value:"Step 5. Click &quot;Create Subscription&quot;",id:"step-5-click-create-subscription",children:[]},{value:"Step 6. Create database",id:"step-6-create-database",children:[]},{value:"Step 7.Installation",id:"step-7installation",children:[]},{value:"Step 8. Create a script file",id:"step-8-create-a-script-file",children:[]},{value:"Step 9. Executing the python script",id:"step-9-executing-the-python-script",children:[]},{value:"Step 10. Monitor the Redis database",id:"step-10-monitor-the-redis-database",children:[]}]},{value:"References",id:"references",children:[]}],l={toc:d};function c(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(s.b)("wrapper",Object(n.a)({},l,a,{components:t,mdxType:"MDXLayout"}),Object(s.b)("p",null,Object(s.b)("img",{alt:"My Image",src:i(532).default})),Object(s.b)("p",null,"Time series data is a series of data stored in the time order (Example: Stock performance over time). Industries today are collecting and analyzing time-based data more than ever before. Traditional databases that rely on relational or document data models are designed neither for storing and indexing data based on time, nor for running time-bucketed aggregation queries. Time-series databases fill this void by providing a data model that optimizes data indexing and querying by time."),Object(s.b)("p",null,"RedisTimeSeries is a Redis module that allows Redis to be used as a fast in-memory time series database designed to collect, manage, and deliver time series data at scale. The RedisTimeSeries module shares the performance and simplicity aspects of Redis. Under the hood, it uses efficient data structures such as Radix tree to index data by timestamp, which makes it extremely fast and efficient to run time-aggregate queries."),Object(s.b)("h2",{id:"redistimeseries-python-client"},"RedisTimeSeries Python Client"),Object(s.b)("p",null,"The redistimeseries-py is a package that gives developers easy access to the RedisTimeSeries module. The package extends ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://github.com/andymccurdy/redis-py"}),"redis-py"),"'s interface with RedisTimeSeries's API."),Object(s.b)("p",null,"Follow the steps below to get started with RedisTimeSeries with Python:"),Object(s.b)("h3",{id:"step-1-create-a-free-redis-enterprise-cloud-account"},"Step 1. Create a free Redis Enterprise cloud account"),Object(s.b)("p",null,"Create your free ",Object(s.b)("a",Object(n.a)({parentName:"p"},{href:"https://redis.com/try-free/"}),"Redis Enterprise Cloud account"),". Once you click on \u201cGet Started\u201d, you will receive an email with a link to activate your account and complete your signup process."),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt_text",src:i(533).default,title:"image_tooltip"})),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt_text",src:i(534).default,title:"image_tooltip"})),Object(s.b)("h3",{id:"step-2-create-your-subscription"},"Step 2. Create Your subscription"),Object(s.b)("p",null,'Next, you will have to create a Redis Enterprise Cloud subscription. In the Redis Enterprise Cloud menu, click "Create your Subscription".'),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt_text",src:i(535).default,title:"image_tooltip"})),Object(s.b)("h3",{id:"step-3-select-the-right-subscription-plan"},"Step 3. Select the right Subscription Plan"),Object(s.b)("p",null,'Select "Fixed Plan" for low throughout application as for now.'),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt_text",src:i(536).default,title:"image_tooltip"})),Object(s.b)("h3",{id:"step-4-select-cloud-vendor"},"Step 4. Select cloud vendor"),Object(s.b)("p",null,"For the cloud provider, select your preferred cloud (for demo purpose)"),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt_text",src:i(537).default,title:"image_tooltip"})),Object(s.b)("h3",{id:"step-5-click-create-subscription"},'Step 5. Click "Create Subscription"'),Object(s.b)("p",null,'Finally, click on the "Create Subscription" button.'),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt_text",src:i(538).default,title:"image_tooltip"})),Object(s.b)("p",null,"You can now verify the subscription as shown below:"),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt_text",src:i(539).default,title:"image_tooltip"})),Object(s.b)("h3",{id:"step-6-create-database"},"Step 6. Create database"),Object(s.b)("p",null,'Click "Create Database". Enter database name and your preferred module.'),Object(s.b)("p",null,Object(s.b)("img",{alt:"alt_text",src:i(540).default,title:"image_tooltip"})),Object(s.b)("h3",{id:"step-7installation"},"Step 7.Installation"),Object(s.b)("pre",null,Object(s.b)("code",Object(n.a)({parentName:"pre"},{}),"$ pip install redistimeseries\n")),Object(s.b)("pre",null,Object(s.b)("code",Object(n.a)({parentName:"pre"},{}),"Collecting redistimeseries\n  Downloading redistimeseries-1.4.3.tar.gz (8.1 kB)\nCollecting hiredis>=0.2.0\n  Downloading hiredis-2.0.0.tar.gz (75 kB)\n     |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 75 kB 4.1 MB/s \nCollecting redis>=2.10\n  Downloading redis-3.5.3-py2.py3-none-any.whl (72 kB)\n     |\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588\u2588| 72 kB 1.1 MB/s \nCollecting rmtest>=0.2\n  Downloading rmtest-0.7.0.tar.gz (6.8 kB)\nUsing legacy setup.py install for redistimeseries, since package 'wheel' is not installed.\nUsing legacy setup.py install for hiredis, since package 'wheel' is not installed.\nUsing legacy setup.py install for rmtest, since package 'wheel' is not installed.\nInstalling collected packages: hiredis, redis, rmtest, redistimeseries\n    Running setup.py install for hiredis ... done\n    Running setup.py install for rmtest ... done\n    Running setup.py install for redistimeseries ... done\nSuccessfully installed hiredis-2.0.0 redis-3.5.3 redistimeseries-1.4.3 rmtest-0.7.0\n")),Object(s.b)("h3",{id:"step-8-create-a-script-file"},"Step 8. Create a script file"),Object(s.b)("pre",null,Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," from redistimeseries.client import Client as RedisTimeSeries\n import time\n import sys\n import site\n import datetime\n import random\n\n print(' \\n '.join(sys.path))\n redis = RedisTimeSeries(host='redis-XXXX.c264.ap-south-1-1.ec2.cloud.redislabs.com', port=<add port>, password=<add password>)\n # redis.flushdb()\n key = 'temperature'\n def create(key):\n        print('\\n Create new time series: %s' % str(key))\n        #redis.create(key,retentionSecs=30,labels={'sensor_id' : 2,'area_id' : 32})\n        redis.create(key,retention_msecs=30000,labels={'sensor_id' : 2,'area_id' : 32})\n        print('')\n def store(key, interval):\n        print(\"\\n Append new value to time series:\\n\")\n        begin_time = int(time.time())\n        for i in range(interval):\n                timestamp = int(time.time())\n                value = round(random.uniform(0.0,100.0),2)\n                timestamp_strftime = datetime.datetime.fromtimestamp(timestamp).strftime('%Y-%m-%d %H:%M:%S')\n                sys.stdout.write(' %s : %.2f \\n' % (timestamp_strftime, value))\n                sys.stdout.flush()\n                #redis.add(key,timestamp,value,retentionSecs=30, labels={'sensor_id' : 2,'area_id' : 32})\n                redis.add(key,timestamp,value,retention_msecs=30000, labels={'sensor_id' : 2,'area_id' : 32})\n                time.sleep(1)\n        end_time = int(time.time()-1)\n        return (begin_time, end_time)\n def query(key, begin_time, end_time):\n        begin_time_datetime = datetime.datetime.fromtimestamp(begin_time).strftime('%Y-%m-%d %H:%M:%S')\n        end_time_datetime = datetime.datetime.fromtimestamp(end_time).strftime('%Y-%m-%d %H:%M:%S')\n        print(\"\\n Query time series in range:\\n\\n %s to %s \\n\" % (begin_time_datetime, end_time_datetime))\n        try:\n                #for record in redis.range(key,begin_time, end_time,bucketSizeSeconds=1):\n                for record in redis.range(key,begin_time, end_time,bucket_size_msec=1000):\n                        timestamp = datetime.datetime.fromtimestamp(record[0]).strftime('%Y-%m-%d %H:%M:%S')\n                        value = round(float(record[1]),2)\n                        print(' %s : %.2f ' % (timestamp,value))\n        except Exception as e:\n                print(\"\\n Error: %s\" % e)\n        print('')\n def print_info():\n        print('\\n Query time series info:\\n')\n        for key in redis.keys('*'):\n                print(' key=%s' % (key.decode('utf8')))\n                info = redis.info(key)\n                sensor = info.labels['sensor_id']\n                print(\" sensor_id=%s \" % str(sensor))\n                area = info.labels['area_id']\n                print(\" area_id=%s \" % str(area))\n                last_time_stamp_seconds = info.__dict__['lastTimeStamp']\n                last_time_stamp = datetime.datetime.fromtimestamp(last_time_stamp_seconds).strftime('%Y-%m-%d %H:%M:%S')\n                print(\" last_time_stamp=%s \" % str(last_time_stamp))\n\n        print('')\n\n def print_loop(loops):\n\n        for i in range(loops):\n\n                if i == 0:\n                        sys.stdout.write(' ')\n\n                sys.stdout.write('.')\n                sys.stdout.flush()\n                time.sleep(1)\n\n        print('')\n\n create(key)\n interval = 10\n begin_time, end_time = store(key,interval)\n time.sleep(1)\n query(key,begin_time,end_time)\n query(key,begin_time+4,end_time-5)\n print_info()\n print('\\n Set expire key: %s' % str(key))\n redis.expire(key, (30))\n loops = 30\n print_loop(loops)\n query(key,begin_time,end_time)\n time.sleep(1)\n interval = 1\n create(key)\n begin_time, end_time = store(key,interval)\n time.sleep(1)\n query(key,begin_time,end_time)\n time.sleep(1)\n print('\\n Delete key: %s' % str(key))\n redis.delete(key)\n time.sleep(1)\n\n query(key,begin_time,end_time)\n\n print('')\n\n")),Object(s.b)("p",null,'Save the above file with a name "ts.py".  '),Object(s.b)("h3",{id:"step-9-executing-the-python-script"},"Step 9. Executing the python script"),Object(s.b)("pre",null,Object(s.b)("code",Object(n.a)({parentName:"pre"},{className:"language-bash"})," python3 ts.py\n")),Object(s.b)("h3",{id:"step-10-monitor-the-redis-database"},"Step 10. Monitor the Redis database"),Object(s.b)("pre",null,Object(s.b)("code",Object(n.a)({parentName:"pre"},{}),'OK\n1635487154.447976 [0 52.149.144.189:40066] "TS.CREATE" "temperature" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487199.379907 [0 52.149.144.189:40572] "AUTH" "9740535000"\n1635487199.575906 [0 52.149.144.189:40572] "TS.CREATE" "temperature" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487199.775906 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487199" "59.85" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487200.975904 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487200" "61.88" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487202.175902 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487202" "90.04" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487203.375900 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487203" "35.47" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487204.575899 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487204" "60.43" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487205.775897 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487205" "45.16" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487206.975895 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487206" "32.69" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487208.175893 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487208" "48.51" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487209.379891 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487209" "27.56" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487210.579889 [0 52.149.144.189:40572] "TS.ADD" "temperature" "1635487210" "53.58" "RETENTION" "30000" "LABELS" "sensor_id" "2" "area_id" "32"\n1635487212.779886 [0 52.149.144.189:40572] "TS.RANGE" "temperature" "1635487199" "1635487210"\n1635487212.979886 [0 52.149.144.189:40572] "TS.RANGE" "temperature" "1635487203" "1635487205"\n')),Object(s.b)("p",null,"You will see bunch of RedisTimeSeries specific commands(TS.ADD. TS.CREATE and TS.RANGE) as shown above."),Object(s.b)("h2",{id:"references"},"References"),Object(s.b)("ul",null,Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"/howtos/redistimeseries/getting-started/"}),"Getting Started with RedisTimeSeries")),Object(s.b)("li",{parentName:"ul"},"Learn more about RedisTimeSeries in the ",Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"https://oss.redis.com/redistimeseries/"}),"Quickstart")," tutorial."),Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"https://redis.com/blog/build-your-financial-application-on-redistimeseries/"}),"Build Your Financial Application on RedisTimeSeries")),Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"https://redis.com/blog/how-to-manage-real-time-iot-sensor-data-in-redis/"}),"How to Manage Real-Time IoT Sensor Data in Redis")),Object(s.b)("li",{parentName:"ul"},Object(s.b)("a",Object(n.a)({parentName:"li"},{href:"https://www.youtube.com/watch?v=rXynFOrrd-Q"}),"Introduction to RedisTimeSeries - Video"))),Object(s.b)("h2",{id:""}),Object(s.b)("div",null,Object(s.b)("a",{href:"https://launchpad.redis.com",target:"_blank",rel:"noopener",className:"link"}," ",Object(s.b)("img",{src:"/img/launchpad.png",className:"thumb",loading:"lazy",alt:"Redis Launchpad"}))))}c.isMDXComponent=!0},296:function(e,t,i){"use strict";i.d(t,"a",(function(){return p})),i.d(t,"b",(function(){return b}));var n=i(0),r=i.n(n);function s(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}function a(e,t){var i=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),i.push.apply(i,n)}return i}function o(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?a(Object(i),!0).forEach((function(t){s(e,t,i[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):a(Object(i)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))}))}return e}function d(e,t){if(null==e)return{};var i,n,r=function(e,t){if(null==e)return{};var i,n,r={},s=Object.keys(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(n=0;n<s.length;n++)i=s[n],t.indexOf(i)>=0||Object.prototype.propertyIsEnumerable.call(e,i)&&(r[i]=e[i])}return r}var l=r.a.createContext({}),c=function(e){var t=r.a.useContext(l),i=t;return e&&(i="function"==typeof e?e(t):o(o({},t),e)),i},p=function(e){var t=c(e.components);return r.a.createElement(l.Provider,{value:t},e.children)},m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},u=r.a.forwardRef((function(e,t){var i=e.components,n=e.mdxType,s=e.originalType,a=e.parentName,l=d(e,["components","mdxType","originalType","parentName"]),p=c(i),u=n,b=p["".concat(a,".").concat(u)]||p[u]||m[u]||s;return i?r.a.createElement(b,o(o({ref:t},l),{},{components:i})):r.a.createElement(b,o({ref:t},l))}));function b(e,t){var i=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var s=i.length,a=new Array(s);a[0]=u;var o={};for(var d in t)hasOwnProperty.call(t,d)&&(o[d]=t[d]);o.originalType=e,o.mdxType="string"==typeof e?e:n,a[1]=o;for(var l=2;l<s;l++)a[l]=i[l];return r.a.createElement.apply(null,a)}return r.a.createElement.apply(null,i)}u.displayName="MDXCreateElement"},532:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/redistimeseries-python-46b664cc5faa36bb37ff7bfef8efbd61.png"},533:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/image2-9489babf8640cb592ee26efc43b8c7c8.png"},534:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/image3-aeb46bc3583a48c327d9a109cb75c06f.png"},535:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/image4-c66aa293e9cf47b78563faeca7e5dfb1.png"},536:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/image5-00ef1afda1542e4aaffedbcd52902eca.png"},537:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/image6-d406dbc870753273bbf867a6d80ee254.png"},538:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/image7-096a05ce08a953dd30698708c555032b.png"},539:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/image8-b517f85390bfa5f00856aed3409a27f1.png"},540:function(e,t,i){"use strict";i.r(t),t.default=i.p+"assets/images/image9-82a8971f206046881ad51b3021d198d4.png"}}]);